parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"PVdp":[function(require,module,exports) {
"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var i=function(){function n(){e(this,n),this.mouse={x:0,y:0},this.keys=new Set,this.handlers={},this.on_click=this.on_click.bind(this),this.on_mouse=this.on_mouse.bind(this),this.on_scroll=this.on_scroll.bind(this),this.init()}return t(n,[{key:"init",value:function(){window.addEventListener("mousemove",this.on_mouse)}},{key:"destroy",value:function(){window.removeEventListener("mousemove",this.on_mouse)}},{key:"emit",value:function(e,n){var t=this;this.handlers[e]&&this.handlers[e].forEach(function(e){return e(t,n)})}},{key:"on",value:function(e,n){this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(n)}},{key:"remove",value:function(e,n){this.handlers[e]&&(this.handlers[e]=this.handlers[e].filter(function(e){return e!==n}))}},{key:"on_click",value:function(){}},{key:"on_mouse",value:function(e){var n=this;this.mouse.x=e.offsetX,this.mouse.y=e.offsetY,this.handlers.mousemove.forEach(function(t){return t(n,e)})}},{key:"on_scroll",value:function(){}}]),n}();exports.default=i;
},{}],"3fHx":[function(require,module,exports) {

"use strict";function r(r,a){return n(r)||e(r,a)||t()}function t(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function e(r,t){var e=[],n=!0,a=!1,o=void 0;try{for(var i,u=r[Symbol.iterator]();!(n=(i=u.next()).done)&&(e.push(i.value),!t||e.length!==t);n=!0);}catch(c){a=!0,o=c}finally{try{n||null==u.return||u.return()}finally{if(a)throw o}}return e}function n(r){if(Array.isArray(r))return r}function a(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function o(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function i(r,t,e){return t&&o(r.prototype,t),e&&o(r,e),r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.to_half=exports.Program=exports.Texture=void 0;var u=function(){function r(t){a(this,r),this.gl=t,this._tex=t.createTexture(),this.bind();for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];t.texImage2D.apply(t,[t.TEXTURE_2D].concat(n)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)}return i(r,[{key:"bind",value:function(){var r=this.gl,t=this._tex;r.bindTexture(r.TEXTURE_2D,t)}},{key:"unbind",value:function(){var r=this.gl;r.bindTexture(r.TEXTURE_2D,null)}}]),r}();exports.Texture=u;var c=function(){function r(){a(this,r)}return i(r,null,[{key:"load",value:function(r,t,e){var n=r.createShader(t);if(r.shaderSource(n,e),r.compileShader(n),r.getShaderParameter(n,r.COMPILE_STATUS))return n;var a=r.getShaderInfoLog(n);throw r.deleteShader(n),new Error("An error occurred compiling a shader: ".concat(a))}}]),r}(),s=function(){function t(e,n,o,i,u){var s=this;a(this,t),this.name=n,this.vert=c.load(e,e.VERTEX_SHADER,o),this.frag=c.load(e,e.FRAGMENT_SHADER,i);var f=e.createProgram();if(e.attachShader(f,this.vert),e.attachShader(f,this.frag),e.linkProgram(f),!e.getProgramParameter(f,e.LINK_STATUS))throw new Error("Unable to link the shader program ".concat(n,": ").concat(e.getProgramInfoLog(f)));this.attrs={},this.uniforms={},this.uniform_setters={},u.attrs&&u.attrs.forEach(function(r){if(s.attrs[r]=e.getAttribLocation(f,r),-1===s.attrs[r])throw new Error('program attr "'.concat(r,'" not found in program "').concat(s.name,'"'))}),u.uniforms&&Object.entries(u.uniforms).forEach(function(t){var n=r(t,2),a=n[0],o=n[1];if(s.uniforms[a]=e.getUniformLocation(f,a),-1===s.uniforms[a])throw new Error('program uniform "'.concat(a,'" not found in program "').concat(s.name,'"'));var i=e["uniform".concat(o)];if(void 0===i)throw new Error('type for program uniform "'.concat(a,'" not recognized in program "').concat(s.name,'"'));s.uniform_setters[a]=i}),this.gl=e,this.pid=f}return i(t,[{key:"attr",value:function(r){var t,e=this.attrs[r];if(-1===e)throw new Error('program attr "'.concat(r,'" not found in program "').concat(this.name,'"'));for(var n=arguments.length,a=new Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];return(t=this.gl).vertexAttribPointer.apply(t,[e].concat(a)),this.gl.enableVertexAttribArray(e),this}},{key:"uniform",value:function(r){this.gl;var t=this.uniforms,e=this.uniform_setters,n=t[r];if(-1===n)throw new Error('program uniform "'.concat(r,'" not found in program "').concat(this.name,'"'));for(var a=e[r],o=arguments.length,i=new Array(o>1?o-1:0),u=1;u<o;u++)i[u-1]=arguments[u];return a.call.apply(a,[this.gl,n].concat(i)),this}},{key:"use",value:function(){return this.gl.useProgram(this.pid),this}},{key:"unuse",value:function(){return this.gl.useProgram(null),this}}],[{key:"build_type_to_uniform_func_map",value:function(r){}}]),t}();exports.Program=s;var f=function r(){a(this,r)},h=function(){var r=new Float32Array(1),t=new Int32Array(r.buffer);return function(e){r[0]=e;var n=t[0],a=n>>16&32768,o=n>>12&2047,i=n>>23&255;return i<103?a:i>142?(a|=31744,a|=(255==i?0:1)&&8388607&n):i<113?a|=((o|=2048)>>114-i)+(o>>113-i&1):(a|=i-112<<10|o>>1,a+=1&o)}}();exports.to_half=h;
},{}],"EaTy":[function(require,module,exports) {
module.exports="#version 300 es\n#define GLSLIFY 1\nlayout(location = 0) in float a_id;\n\nuniform uint u_num_particles;\n\nout float _u_target;\n\nvoid main() {\n  _u_target = a_id / float(u_num_particles);\n  gl_Position = vec4(2.f * (_u_target - 0.5f), 0, 0, 1.f);\n  gl_PointSize = 1.f;\n}\n";
},{}],"xew+":[function(require,module,exports) {
module.exports="#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\n\nin float _u_target;\n\nuniform float u_dt;\nuniform sampler2D u_pos_buf;\nuniform sampler2D u_vel_buf;\n\nlayout(location = 0) out vec2 _pred_pos;\n\nvoid main() {\n  vec2 pos = texture(u_pos_buf, vec2(_u_target, 0)).xy;\n  vec2 vel = texture(u_vel_buf, vec2(_u_target, 0)).xy;\n\n  vec2 dp = (vel + vec2(0, -9.8f) * u_dt) * u_dt;\n  // vec2 dp = (vel + vec2(0) * u_dt) * u_dt;\n\n  _pred_pos = pos + dp;\n}";
},{}],"Vbf9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./shaders/pred-pos.vert")),r=t(require("./shaders/pred-pos.frag")),u=require("~/src/gl-util");function t(e){return e&&e.__esModule?e:{default:e}}var s=function(t,s,i){return function(){var s;return{init:function(){s=new u.Program(t,"pred-pos",e.default,r.default,{attrs:["a_id"],uniforms:{u_num_particles:"1ui",u_dt:"1f",u_pos_buf:"1i",u_vel_buf:"1i"}}),t.bindBuffer(t.ARRAY_BUFFER,i.buffers.particle_ids),s.attr("a_id",1,t.UNSIGNED_SHORT,!1,0,0).use().uniform("u_num_particles",i.num_particles).uniform("u_dt",i.s_params.dt).uniform("u_pos_buf",0).uniform("u_vel_buf",1).unuse()},exec:function(){var e=i.swap_fbo();t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i.textures.pred_pos._tex,0),t.activeTexture(t.TEXTURE0),i.textures.pos.bind(),t.activeTexture(t.TEXTURE1),i.textures.vel.bind(),s.use(),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.viewport(0,0,i.num_particles,1),t.drawArrays(t.POINTS,0,i.num_particles),s.unuse()}}}()};exports.default=s;
},{"./shaders/pred-pos.vert":"EaTy","./shaders/pred-pos.frag":"xew+","~/src/gl-util":"3fHx"}],"SQxo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r=function(r,e,n){var a,s,t,_,i;function u(r,e){var a=Math.trunc(r/n.s_params.bin_size);return Math.trunc(e/n.s_params.bin_size)*n.s_params.x_bins+a}return{init:function(){a=new Float32Array(4*n.num_particles),s=new Uint16Array(n.s_params.num_bins),t=new Uint32Array(n.num_particles),_=new Uint32Array(n.s_params.num_bins),i=new Uint32Array(n.s_params.num_bins)},exec:function(){var e,m=n.swap_fbo();r.bindFramebuffer(r.FRAMEBUFFER,m),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n.textures.pred_pos._tex,0),r.readPixels(0,0,n.num_particles,1,r.RGBA,r.FLOAT,a),i.fill(0);for(var E=0;E<4*n.num_particles;E+=4)e=u(a[E],a[E+1]),++i[e];s[0]=i[0],_[0]=0;for(var p=1;p<n.s_params.num_bins;++p)s[p]=s[p-1]+i[p],_[p]=_[p-1]+i[p-1];for(var b=n.num_particles-1;b>=0;--b)e=u(a[4*b],a[4*b+1]),t[--s[e]]=b;n.textures.bins.bind(),r.texImage2D(r.TEXTURE_2D,0,r.R32UI,n.num_particles,1,0,r.RED_INTEGER,r.UNSIGNED_INT,t),n.textures.bin_count.bind(),r.texImage2D(r.TEXTURE_2D,0,r.R32UI,n.s_params.num_bins,1,0,r.RED_INTEGER,r.UNSIGNED_INT,i),n.textures.bin_start.bind(),r.texImage2D(r.TEXTURE_2D,0,r.R32UI,n.s_params.num_bins,1,0,r.RED_INTEGER,r.UNSIGNED_INT,_)}}};exports.default=r;
},{}],"G/d1":[function(require,module,exports) {
module.exports="#version 300 es\n#define GLSLIFY 1\nlayout(location = 0) in float a_id;\n\nuniform mediump uint u_num_particles;\n\nout float _u_target;\nout float _id;\n\nvoid main() {\n  _u_target = a_id / float(u_num_particles);\n  _id = a_id;\n\n  gl_Position = vec4(2.f * (_u_target - 0.5f), 0, 0, 1.f);\n  gl_PointSize = 1.f;\n}";
},{}],"ehho":[function(require,module,exports) {
module.exports="#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\n\n#define PI 3.14159265358979323846264338327950288f\n#define EPS_F 1e-23f\n\nin float _u_target;\nin float _id;\n\nuniform uint u_num_particles;\nuniform float u_kernel_r;\nuniform float u_rest_density;\nuniform float u_relaxation;\nuniform float u_bin_size;\nuniform uint u_x_bins;\nuniform uint u_num_bins;\n\nuniform sampler2D u_pred_pos;\nuniform mediump usampler2D u_bins;\nuniform mediump usampler2D u_bin_count;\nuniform mediump usampler2D u_bin_start;\n\nlayout(location = 0) out float _den;\n\nfloat poly6(vec2 ri) {\n  float r = length(ri);\n  if (r >= u_kernel_r || r < EPS_F)\n    return 0.f;\n  return (315.f / (64.f * PI * pow(u_kernel_r, 9.f))) * pow(u_kernel_r * u_kernel_r - r * r, 3.f);\n}\n\nvec2 grad_spiky(vec2 ri) {\n  float r = length(ri);\n  if (r >= u_kernel_r || r < EPS_F)\n    return vec2(0.f);\n  return (-45.f / (PI * pow(u_kernel_r, 6.f))) * pow(u_kernel_r - r, 2.f) * normalize(ri);\n}\n\nivec2 bin_index(vec2 pos) {\n  uint x_c = uint(pos.x / u_bin_size);\n  uint y_c = uint(pos.y / u_bin_size);\n  return ivec2(x_c, y_c);\n}\n\nuint bin(ivec2 bin_index) {\n  return uint(bin_index.y) * u_x_bins + uint(bin_index.x);\n}\n\nvoid main() {\n  vec2 p_i = texture(u_pred_pos, vec2(_u_target, 0)).xy;\n  ivec2 bin_index = bin_index(p_i);\n\n  uint id_i = uint(_id);\n  vec2 target_j_id;\n  uint id_j;\n  vec2 target_j;\n  vec2 p_j;\n  vec2 grad_ci_pk;\n\n  vec2 grad_ci_pi = vec2(0.f);\n  float density = 0.f;\n  float denom = 0.f;\n\n  for (int i = -1; i <= 1; ++i) {\n    for (int j = -1; j <= 1; ++j) {\n      uint b = bin(bin_index + ivec2(i, j));\n      vec2 bin_uv = vec2(float(b) / float(u_num_bins), 0.f);\n      uint count = texture(u_bin_count, bin_uv).x;\n      uint start = texture(u_bin_start, bin_uv).x;\n\n      for (uint k = start; k < start + count; ++k) {\n        target_j_id = vec2(float(k) / float(u_num_particles), 0);\n        id_j = texture(u_bins, target_j_id).x;\n        target_j = vec2(float(id_j) / float(u_num_particles), 0);\n        p_j = texture(u_pred_pos, target_j).xy;\n\n        // accumulate density\n        density += poly6(p_i - p_j);\n\n        // accumulate denominator\n        grad_ci_pk = grad_spiky(p_i - p_j);\n        if (id_i != id_j)\n          denom += dot(grad_ci_pk, grad_ci_pk);\n        grad_ci_pi += grad_ci_pk;\n      }\n    }\n  }\n\n  float num = density / u_rest_density - 1.f;\n  denom += dot(grad_ci_pi, grad_ci_pi);\n  _den = -num / (denom / pow(u_rest_density, 2.f) + u_relaxation);\n}";
},{}],"ktUN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=i(require("./shaders/calc-lambda.vert")),r=i(require("./shaders/calc-lambda.frag")),u=require("~/src/gl-util");function i(e){return e&&e.__esModule?e:{default:e}}var n=function(i,n,_){var t;return{init:function(){t=new u.Program(i,"calc-lambda",e.default,r.default,{attrs:["a_id"],uniforms:{u_num_particles:"1ui",u_kernel_r:"1f",u_rest_density:"1f",u_relaxation:"1f",u_bin_size:"1f",u_x_bins:"1ui",u_num_bins:"1ui",u_pred_pos:"1i",u_bins:"1i",u_bin_count:"1i",u_bin_start:"1i"}}),i.bindBuffer(i.ARRAY_BUFFER,_.buffers.particle_ids),t.attr("a_id",1,i.UNSIGNED_SHORT,!1,0,0).use().uniform("u_num_particles",_.num_particles).uniform("u_kernel_r",_.s_params.kernel_r).uniform("u_rest_density",_.s_params.rest_density).uniform("u_relaxation",_.s_params.relaxation).uniform("u_bin_size",_.s_params.bin_size).uniform("u_x_bins",_.s_params.x_bins).uniform("u_num_bins",_.s_params.num_bins).uniform("u_pred_pos",0).uniform("u_bins",1).uniform("u_bin_count",2).uniform("u_bin_start",3).unuse()},exec:function(){var e=_.swap_fbo();i.bindFramebuffer(i.FRAMEBUFFER,e),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,_.textures.den._tex,0),i.activeTexture(i.TEXTURE0),_.textures.pred_pos.bind(),i.activeTexture(i.TEXTURE1),_.textures.bins.bind(),i.activeTexture(i.TEXTURE2),_.textures.bin_count.bind(),i.activeTexture(i.TEXTURE3),_.textures.bin_start.bind(),t.use(),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.viewport(0,0,_.num_particles,1),i.drawArrays(i.POINTS,0,_.num_particles),t.unuse()}}};exports.default=n;
},{"./shaders/calc-lambda.vert":"G/d1","./shaders/calc-lambda.frag":"ehho","~/src/gl-util":"3fHx"}],"bJFj":[function(require,module,exports) {
module.exports="#version 300 es\n#define GLSLIFY 1\nlayout(location = 0) in float a_id;\n\nuniform mediump uint u_num_particles;\n\nout float _u_target;\n\nvoid main() {\n  _u_target = a_id / float(u_num_particles);\n\n  gl_Position = vec4(2.f * (_u_target - 0.5f), 0, 0, 1.f);\n  gl_PointSize = 1.f;\n}";
},{}],"rfA7":[function(require,module,exports) {
module.exports="#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\n\n#define PI 3.14159265358979323846264338327950288f\n#define EPS_F 1e-23f\n\nin float _u_target;\n\nuniform uint u_num_particles;\nuniform float u_kernel_r;\nuniform float u_rest_density;\nuniform float u_s_corr_dq_mult;\nuniform float u_s_corr_k;\nuniform float u_s_corr_n;\nuniform float u_bin_size;\nuniform uint u_x_bins;\nuniform uint u_num_bins;\nuniform sampler2D u_pred_pos;\nuniform sampler2D u_lambda;\nuniform mediump usampler2D u_bins;\nuniform mediump usampler2D u_bin_count;\nuniform mediump usampler2D u_bin_start;\n\nlayout(location = 0) out vec2 _d_pos;\n\nfloat poly6(vec2 ri) {\n  float r = length(ri);\n  if (r >= u_kernel_r || r < EPS_F)\n    return 0.f;\n  return (315.f / (64.f * PI * pow(u_kernel_r, 9.f))) * pow(u_kernel_r * u_kernel_r - r * r, 3.f);\n}\n\nvec2 grad_spiky(vec2 ri) {\n  float r = length(ri);\n  if (r >= u_kernel_r || r < EPS_F)\n    return vec2(0.f);\n  return (-45.f / (PI * pow(u_kernel_r, 6.f))) * pow(u_kernel_r - r, 2.f) * normalize(ri);\n}\n\nivec2 bin_index(vec2 pos) {\n  uint x_c = uint(pos.x / u_bin_size);\n  uint y_c = uint(pos.y / u_bin_size);\n  return ivec2(x_c, y_c);\n}\n\nuint bin(ivec2 bin_index) {\n  return uint(bin_index.y) * u_x_bins + uint(bin_index.x);\n}\n\nvoid main() {\n  float lambda_i = texture(u_lambda, vec2(_u_target, 0)).x;\n  vec2 p_i = texture(u_pred_pos, vec2(_u_target, 0)).xy;\n  ivec2 bin_index = bin_index(p_i);\n\n  float s_corr_mult = -u_s_corr_k / pow(poly6(vec2(u_s_corr_dq_mult, 0)), u_s_corr_n);\n\n  uint b;\n  vec2 target_j_id;\n  uint id_j;\n  vec2 target_j;  \n\n  float lambda_j;\n  vec2 p_j;\n  vec2 sum = vec2(0.f);\n\n  for (int i = -1; i <= 1; ++i) {\n    for (int j = -1; j <= 1; ++j) {\n      b = bin(bin_index + ivec2(i, j));\n      vec2 bin_uv = vec2(float(b) / float(u_num_bins), 0.f);\n      uint count = texture(u_bin_count, bin_uv).x;\n      uint start = texture(u_bin_start, bin_uv).x;\n\n      for (uint k = start; k < start + count; ++k) {\n        target_j_id = vec2(float(k) / float(u_num_particles), 0);\n        id_j = texture(u_bins, target_j_id).x;\n        target_j = vec2(float(id_j) / float(u_num_particles), 0);\n\n        lambda_j = texture(u_lambda, target_j).x;\n        p_j = texture(u_pred_pos, target_j).xy;\n\n        vec2 r = p_i - p_j;\n        float s_corr = s_corr_mult * pow(poly6(r), u_s_corr_n);\n        // float s_corr = 0.f;\n        sum += (lambda_i + lambda_j + s_corr) * grad_spiky(r);\n      }\n    }\n  }\n\n  _d_pos = sum / u_rest_density;\n}";
},{}],"x0rW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r=e(require("./shaders/calc-dp.vert")),_=e(require("./shaders/calc-dp.frag")),u=require("~/src/gl-util");function e(r){return r&&r.__esModule?r:{default:r}}var s=function(e,s,i){var n;return{init:function(){n=new u.Program(e,"calc-dp",r.default,_.default,{attrs:["a_id"],uniforms:{u_num_particles:"1ui",u_kernel_r:"1f",u_rest_density:"1f",u_s_corr_dq_mult:"1f",u_s_corr_k:"1f",u_s_corr_n:"1f",u_bin_size:"1f",u_x_bins:"1ui",u_num_bins:"1ui",u_pred_pos:"1i",u_lambda:"1i",u_bins:"1i",u_bin_count:"1i",u_bin_start:"1i"}}),e.bindBuffer(e.ARRAY_BUFFER,i.buffers.particle_ids),n.attr("a_id",1,e.UNSIGNED_SHORT,!1,0,0).use().uniform("u_num_particles",i.num_particles).uniform("u_kernel_r",i.s_params.kernel_r).uniform("u_rest_density",i.s_params.rest_density).uniform("u_s_corr_dq_mult",i.s_params.s_corr_dq_mult).uniform("u_s_corr_k",i.s_params.s_corr_k).uniform("u_s_corr_n",i.s_params.s_corr_n).uniform("u_bin_size",i.s_params.bin_size).uniform("u_x_bins",i.s_params.x_bins).uniform("u_num_bins",i.s_params.num_bins).uniform("u_pred_pos",0).uniform("u_lambda",1).uniform("u_bins",2).uniform("u_bin_count",3).uniform("u_bin_start",4).unuse()},exec:function(){var r=i.swap_fbo();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i.textures.d_pos._tex,0),e.activeTexture(e.TEXTURE0),i.textures.pred_pos.bind(),e.activeTexture(e.TEXTURE1),i.textures.den.bind(),e.activeTexture(e.TEXTURE2),i.textures.bins.bind(),e.activeTexture(e.TEXTURE3),i.textures.bin_count.bind(),e.activeTexture(e.TEXTURE4),i.textures.bin_start.bind(),n.use(),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.viewport(0,0,i.num_particles,1),e.drawArrays(e.POINTS,0,i.num_particles),n.unuse()}}};exports.default=s;
},{"./shaders/calc-dp.vert":"bJFj","./shaders/calc-dp.frag":"rfA7","~/src/gl-util":"3fHx"}],"v0ic":[function(require,module,exports) {
module.exports="#version 300 es\n#define GLSLIFY 1\nlayout(location = 0) in float a_id;\n\nuniform uint u_num_particles;\n\nout float _u_target;\n\nvoid main() {\n  _u_target = a_id / float(u_num_particles);\n  gl_Position = vec4(2.f * (_u_target - 0.5f), 0, 0, 1.f);\n  gl_PointSize = 1.f;\n}";
},{}],"5Eac":[function(require,module,exports) {
module.exports="#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\n\nin float _u_target;\n\nuniform sampler2D u_pred_pos;\nuniform sampler2D u_d_pos;\n\nlayout(location = 0) out vec2 _pred_pos;\n\nvec2 clamp_vec2(vec2 v, float x_min, float x_max, float y_min, float y_max) {\n  return vec2(clamp(v.x, x_min, x_max), clamp(v.y, y_min, y_max));\n}\n\nvoid main() {\n  vec2 t = vec2(_u_target, 0);\n  vec2 pred_pos = texture(u_pred_pos, t).xy;\n  vec2 dp = texture(u_d_pos, t).xy;\n  _pred_pos = clamp_vec2(pred_pos + dp, 0.1f, 3.9f, 0.f, 2.f);\n}";
},{}],"LfWM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./shaders/update-pred-pos.vert")),r=t(require("./shaders/update-pred-pos.frag")),u=require("~/src/gl-util");function t(e){return e&&e.__esModule?e:{default:e}}var s=function(t,s,a){return function(){var s;return{init:function(){s=new u.Program(t,"pred-pos-update",e.default,r.default,{attrs:["a_id"],uniforms:{u_num_particles:"1ui",u_pred_pos:"1i",u_d_pos:"1i"}}),t.bindBuffer(t.ARRAY_BUFFER,a.buffers.particle_ids),s.attr("a_id",1,t.UNSIGNED_SHORT,!1,0,0).use().uniform("u_num_particles",a.num_particles).uniform("u_pred_pos",0).uniform("u_d_pos",1).unuse()},exec:function(){var e=a.swap_fbo();t.bindFramebuffer(t.FRAMEBUFFER,e);var r=a.textures.temp;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r._tex,0),t.activeTexture(t.TEXTURE0),a.textures.pred_pos.bind(),t.activeTexture(t.TEXTURE1),a.textures.d_pos.bind(),s.use(),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.viewport(0,0,a.num_particles,1),t.drawArrays(t.POINTS,0,a.num_particles),s.unuse(),a.textures.temp=a.textures.pred_pos,a.textures.pred_pos=r}}}()};exports.default=s;
},{"./shaders/update-pred-pos.vert":"v0ic","./shaders/update-pred-pos.frag":"5Eac","~/src/gl-util":"3fHx"}],"Y5yN":[function(require,module,exports) {
module.exports="#version 300 es\n#define GLSLIFY 1\nlayout(location = 0) in float a_id;\n\nuniform mediump uint u_num_particles;\n\nout float _u_target;\n\nvoid main() {\n  _u_target = a_id / float(u_num_particles);\n  gl_Position = vec4(2.f * (_u_target - 0.5f), 0, 0, 1.f);\n  gl_PointSize = 1.f;\n}";
},{}],"YV8J":[function(require,module,exports) {
module.exports="#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\n\nin float _u_target;\n\nuniform float u_dt;\nuniform sampler2D u_pos_buf;\nuniform sampler2D u_pred_pos_buf;\n\nlayout(location = 0) out vec2 _vel;\n\nvoid main() {\n  vec2 uv = vec2(_u_target, 0);\n  vec2 pos = texture(u_pos_buf, uv).xy;\n  vec2 pred_pos = texture(u_pred_pos_buf, uv).xy;\n  _vel = (pred_pos - pos) / u_dt;\n}";
},{}],"txXs":[function(require,module,exports) {
module.exports="#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\n\n#define PI 3.14159265358979323846264338327950288f\n#define EPS_F 1e-23f\n\nin float _u_target;\n\nuniform uint u_num_particles;\nuniform float u_dt;\nuniform float u_kernel_r;\nuniform float u_vort_eps;\nuniform float u_visc_c;\nuniform float u_bin_size;\nuniform uint u_x_bins;\nuniform uint u_num_bins;\n\nuniform sampler2D u_pred_pos;\nuniform sampler2D u_vel;\nuniform mediump usampler2D u_bins;\nuniform mediump usampler2D u_bin_count;\nuniform mediump usampler2D u_bin_start;\n\nlayout(location = 0) out vec2 _vel;\n\nfloat poly6(vec2 ri) {\n  float r = length(ri);\n  if (r >= u_kernel_r || r < EPS_F)\n    return 0.f;\n  return (315.f / (64.f * PI * pow(u_kernel_r, 9.f))) * pow(u_kernel_r * u_kernel_r - r * r, 3.f);\n}\n\nvec2 grad_spiky(vec2 ri) {\n  float r = length(ri);\n  if (r >= u_kernel_r || r < EPS_F)\n    return vec2(0.f);\n  return (-45.f / (PI * pow(u_kernel_r, 6.f))) * pow(u_kernel_r - r, 2.f) * normalize(ri);\n}\n\nivec2 bin_index(vec2 pos) {\n  uint x_c = uint(pos.x / u_bin_size);\n  uint y_c = uint(pos.y / u_bin_size);\n  return ivec2(x_c, y_c);\n}\n\nuint bin(ivec2 bin_index) {\n  return uint(bin_index.y) * u_x_bins + uint(bin_index.x);\n}\n\nvoid main() {\n  vec2 uv = vec2(_u_target, 0);\n  vec2 p_i = texture(u_pred_pos, uv).xy;\n  vec2 v_i = texture(u_vel, uv).xy;\n  ivec2 bin_index = bin_index(p_i);\n\n  uint b;\n  vec2 bin_uv;\n  uint count;\n  uint start;\n  vec2 target_j_id;\n  uint id_j;\n  vec2 target_j;  \n  vec2 v_j;\n\n  vec2 p_j;\n  vec3 w_i = vec3(0);\n  vec3 p_cross = vec3(0);\n  vec2 xsph_sum = vec2(0);\n\n  for (int i = -1; i <= 1; ++i) {\n    for (int j = -1; j <= 1; ++j) {\n      b = bin(bin_index + ivec2(i, j));\n      bin_uv = vec2(float(b) / float(u_num_bins), 0);\n      count = texture(u_bin_count, bin_uv).x;\n      start = texture(u_bin_start, bin_uv).x;\n\n      for (uint k = start; k < start + count; ++k) {\n        target_j_id = vec2(float(k) / float(u_num_particles), 0);\n        id_j = texture(u_bins, target_j_id).x;\n        target_j = vec2(float(id_j) / float(u_num_particles), 0);\n\n        p_j = texture(u_pred_pos, target_j).xy;\n        v_j = texture(u_vel, target_j).xy;\n\n        vec2 r = p_i - p_j;\n        vec2 v_ij = v_j - v_i;\n\n        w_i += cross(vec3(v_ij, 0), vec3(grad_spiky(r), 0));\n        p_cross += vec3(0.5 * (p_i + p_j) - p_i, 0);\n\n        xsph_sum += poly6(r) * v_ij;\n      }\n    }\n  }\n\n  vec3 n = normalize(p_cross - vec3(p_i, 0));\n  vec3 f_vort = vec3(0);\n  if (length(n) > EPS_F)\n    f_vort = u_vort_eps * cross(n, w_i);\n\n  _vel = v_i + u_visc_c * xsph_sum + (u_dt * f_vort).xy;\n}";
},{}],"euvS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=i(require("./shaders/update-vel.vert")),r=i(require("./shaders/update-vel.frag")),u=i(require("./shaders/visc-vort.vert")),t=i(require("./shaders/visc-vort.frag")),_=require("~/src/gl-util");function i(e){return e&&e.__esModule?e:{default:e}}var s=function(i,s,n){return function(){var s,a;return{init:function(){s=new _.Program(i,"vel-update",e.default,r.default,{attrs:["a_id"],uniforms:{u_num_particles:"1ui",u_dt:"1f",u_pos_buf:"1i",u_pred_pos_buf:"1i"}}),a=new _.Program(i,"visc-vort",u.default,t.default,{attrs:["a_id"],uniforms:{u_num_particles:"1ui",u_dt:"1f",u_kernel_r:"1f",u_vort_eps:"1f",u_visc_c:"1f",u_bin_size:"1f",u_x_bins:"1ui",u_num_bins:"1ui",u_pred_pos:"1i",u_vel:"1i",u_bins:"1i",u_bin_count:"1i",u_bin_start:"1i"}}),i.bindBuffer(i.ARRAY_BUFFER,n.buffers.particle_ids),s.attr("a_id",1,i.UNSIGNED_SHORT,!1,0,0).use().uniform("u_num_particles",n.num_particles).uniform("u_dt",n.s_params.dt).uniform("u_pos_buf",0).uniform("u_pred_pos_buf",1).unuse(),a.attr("a_id",1,i.UNSIGNED_SHORT,!1,0,0).use().uniform("u_num_particles",n.num_particles).uniform("u_dt",n.s_params.dt).uniform("u_kernel_r",n.s_params.kernel_r).uniform("u_vort_eps",n.s_params.vort_eps).uniform("u_visc_c",n.s_params.visc_c).uniform("u_bin_size",n.s_params.bin_size).uniform("u_x_bins",n.s_params.x_bins).uniform("u_num_bins",n.s_params.num_bins).uniform("u_pred_pos",1).uniform("u_vel",2).uniform("u_bins",3).uniform("u_bin_count",4).uniform("u_bin_start",5).unuse()},exec:function(){var e=n.swap_fbo();i.bindFramebuffer(i.FRAMEBUFFER,e),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,n.textures.vel._tex,0),i.activeTexture(i.TEXTURE0),n.textures.pos.bind(),i.activeTexture(i.TEXTURE1),n.textures.pred_pos.bind(),s.use(),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.viewport(0,0,n.num_particles,1),i.drawArrays(i.POINTS,0,n.num_particles),s.unuse();var r=n.textures.temp;e=n.swap_fbo(),i.bindFramebuffer(i.FRAMEBUFFER,e),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,r._tex,0),i.activeTexture(i.TEXTURE2),n.textures.vel.bind(),i.activeTexture(i.TEXTURE3),n.textures.bins.bind(),i.activeTexture(i.TEXTURE4),n.textures.bin_count.bind(),i.activeTexture(i.TEXTURE5),n.textures.bin_start.bind(),a.use(),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.viewport(0,0,n.num_particles,1),i.drawArrays(i.POINTS,0,n.num_particles),a.unuse(),n.textures.temp=n.textures.vel,n.textures.vel=r}}}()};exports.default=s;
},{"./shaders/update-vel.vert":"Y5yN","./shaders/update-vel.frag":"YV8J","./shaders/visc-vort.vert":"Y5yN","./shaders/visc-vort.frag":"txXs","~/src/gl-util":"3fHx"}],"N0tB":[function(require,module,exports) {
module.exports="#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\n\nin float _u_target;\n\nuniform sampler2D u_pred_pos_buf;\n\nlayout(location = 0) out vec2 _pos;\n\nvoid main() {\n  vec2 pos = texture(u_pred_pos_buf, vec2(_u_target, 0)).xy;\n  _pos = pos;\n}";
},{}],"YHhg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./shaders/update-pos.vert")),r=t(require("./shaders/update-pos.frag")),u=require("~/src/gl-util");function t(e){return e&&e.__esModule?e:{default:e}}var s=function(t,s,a){return function(){var s;return{init:function(){s=new u.Program(t,"pos-update",e.default,r.default,{attrs:["a_id"],uniforms:{u_num_particles:"1ui",u_pred_pos_buf:"1i"}}),t.bindBuffer(t.ARRAY_BUFFER,a.buffers.particle_ids),s.attr("a_id",1,t.UNSIGNED_SHORT,!1,0,0).use().uniform("u_pred_pos_buf",0).uniform("u_num_particles",a.num_particles).unuse()},exec:function(){var e=a.swap_fbo();t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,a.textures.pos._tex,0),t.activeTexture(t.TEXTURE0),a.textures.pred_pos.bind(),s.use(),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.viewport(0,0,a.num_particles,1),t.drawArrays(t.POINTS,0,a.num_particles),s.unuse()}}}()};exports.default=s;
},{"./shaders/update-pos.vert":"v0ic","./shaders/update-pos.frag":"N0tB","~/src/gl-util":"3fHx"}],"XJqx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setMatrixArrayType=a,exports.toRadian=s,exports.equals=p,exports.RANDOM=exports.ARRAY_TYPE=exports.EPSILON=void 0;var r=1e-6;exports.EPSILON=r;var t="undefined"!=typeof Float32Array?Float32Array:Array;exports.ARRAY_TYPE=t;var e=Math.random;function a(r){exports.ARRAY_TYPE=t=r}exports.RANDOM=e;var o=Math.PI/180;function s(r){return r*o}function p(t,e){return Math.abs(t-e)<=r*Math.max(1,Math.abs(t),Math.abs(e))}
},{}],"eN7R":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=e,exports.clone=n,exports.copy=o,exports.identity=a,exports.fromValues=u,exports.set=s,exports.transpose=i,exports.invert=p,exports.adjoint=c,exports.determinant=f,exports.multiply=x,exports.rotate=l,exports.scale=M,exports.fromRotation=h,exports.fromScaling=b,exports.str=v,exports.frob=m,exports.LDU=d,exports.add=P,exports.subtract=y,exports.exactEquals=O,exports.equals=A,exports.multiplyScalar=w,exports.multiplyScalarAndAdd=E,exports.sub=exports.mul=void 0;var t=r(require("./common.js"));function r(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,e):{};n.get||n.set?Object.defineProperty(r,e,n):r[e]=t[e]}return r.default=t,r}function e(){var r=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r}function n(r){var e=new t.ARRAY_TYPE(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function o(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t}function a(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function u(r,e,n,o){var a=new t.ARRAY_TYPE(4);return a[0]=r,a[1]=e,a[2]=n,a[3]=o,a}function s(t,r,e,n,o){return t[0]=r,t[1]=e,t[2]=n,t[3]=o,t}function i(t,r){if(t===r){var e=r[1];t[1]=r[2],t[2]=e}else t[0]=r[0],t[1]=r[2],t[2]=r[1],t[3]=r[3];return t}function p(t,r){var e=r[0],n=r[1],o=r[2],a=r[3],u=e*a-o*n;return u?(u=1/u,t[0]=a*u,t[1]=-n*u,t[2]=-o*u,t[3]=e*u,t):null}function c(t,r){var e=r[0];return t[0]=r[3],t[1]=-r[1],t[2]=-r[2],t[3]=e,t}function f(t){return t[0]*t[3]-t[2]*t[1]}function x(t,r,e){var n=r[0],o=r[1],a=r[2],u=r[3],s=e[0],i=e[1],p=e[2],c=e[3];return t[0]=n*s+a*i,t[1]=o*s+u*i,t[2]=n*p+a*c,t[3]=o*p+u*c,t}function l(t,r,e){var n=r[0],o=r[1],a=r[2],u=r[3],s=Math.sin(e),i=Math.cos(e);return t[0]=n*i+a*s,t[1]=o*i+u*s,t[2]=n*-s+a*i,t[3]=o*-s+u*i,t}function M(t,r,e){var n=r[0],o=r[1],a=r[2],u=r[3],s=e[0],i=e[1];return t[0]=n*s,t[1]=o*s,t[2]=a*i,t[3]=u*i,t}function h(t,r){var e=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=e,t[2]=-e,t[3]=n,t}function b(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=r[1],t}function v(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function m(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))}function d(t,r,e,n){return t[2]=n[2]/n[0],e[0]=n[0],e[1]=n[1],e[3]=n[3]-t[2]*e[1],[t,r,e]}function P(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t}function y(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t[3]=r[3]-e[3],t}function O(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]}function A(r,e){var n=r[0],o=r[1],a=r[2],u=r[3],s=e[0],i=e[1],p=e[2],c=e[3];return Math.abs(n-s)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-i)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(i))&&Math.abs(a-p)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(u-c)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(c))}function w(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t}function E(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t[3]=r[3]+e[3]*n,t}var R=x;exports.mul=R;var j=y;exports.sub=j;
},{"./common.js":"XJqx"}],"M21d":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=e,exports.clone=a,exports.copy=n,exports.identity=o,exports.fromValues=s,exports.set=u,exports.invert=i,exports.determinant=p,exports.multiply=c,exports.rotate=f,exports.scale=M,exports.translate=h,exports.fromRotation=x,exports.fromScaling=l,exports.fromTranslation=b,exports.str=m,exports.frob=v,exports.add=P,exports.subtract=d,exports.multiplyScalar=O,exports.multiplyScalarAndAdd=y,exports.exactEquals=w,exports.equals=A,exports.sub=exports.mul=void 0;var t=r(require("./common.js"));function r(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,e):{};a.get||a.set?Object.defineProperty(r,e,a):r[e]=t[e]}return r.default=t,r}function e(){var r=new t.ARRAY_TYPE(6);return t.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[4]=0,r[5]=0),r[0]=1,r[3]=1,r}function a(r){var e=new t.ARRAY_TYPE(6);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e}function n(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t}function o(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function s(r,e,a,n,o,s){var u=new t.ARRAY_TYPE(6);return u[0]=r,u[1]=e,u[2]=a,u[3]=n,u[4]=o,u[5]=s,u}function u(t,r,e,a,n,o,s){return t[0]=r,t[1]=e,t[2]=a,t[3]=n,t[4]=o,t[5]=s,t}function i(t,r){var e=r[0],a=r[1],n=r[2],o=r[3],s=r[4],u=r[5],i=e*o-a*n;return i?(i=1/i,t[0]=o*i,t[1]=-a*i,t[2]=-n*i,t[3]=e*i,t[4]=(n*u-o*s)*i,t[5]=(a*s-e*u)*i,t):null}function p(t){return t[0]*t[3]-t[1]*t[2]}function c(t,r,e){var a=r[0],n=r[1],o=r[2],s=r[3],u=r[4],i=r[5],p=e[0],c=e[1],f=e[2],M=e[3],h=e[4],x=e[5];return t[0]=a*p+o*c,t[1]=n*p+s*c,t[2]=a*f+o*M,t[3]=n*f+s*M,t[4]=a*h+o*x+u,t[5]=n*h+s*x+i,t}function f(t,r,e){var a=r[0],n=r[1],o=r[2],s=r[3],u=r[4],i=r[5],p=Math.sin(e),c=Math.cos(e);return t[0]=a*c+o*p,t[1]=n*c+s*p,t[2]=a*-p+o*c,t[3]=n*-p+s*c,t[4]=u,t[5]=i,t}function M(t,r,e){var a=r[0],n=r[1],o=r[2],s=r[3],u=r[4],i=r[5],p=e[0],c=e[1];return t[0]=a*p,t[1]=n*p,t[2]=o*c,t[3]=s*c,t[4]=u,t[5]=i,t}function h(t,r,e){var a=r[0],n=r[1],o=r[2],s=r[3],u=r[4],i=r[5],p=e[0],c=e[1];return t[0]=a,t[1]=n,t[2]=o,t[3]=s,t[4]=a*p+o*c+u,t[5]=n*p+s*c+i,t}function x(t,r){var e=Math.sin(r),a=Math.cos(r);return t[0]=a,t[1]=e,t[2]=-e,t[3]=a,t[4]=0,t[5]=0,t}function l(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=r[1],t[4]=0,t[5]=0,t}function b(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=r[0],t[5]=r[1],t}function m(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function v(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)}function P(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t[4]=r[4]+e[4],t[5]=r[5]+e[5],t}function d(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t[3]=r[3]-e[3],t[4]=r[4]-e[4],t[5]=r[5]-e[5],t}function O(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t[4]=r[4]*e,t[5]=r[5]*e,t}function y(t,r,e,a){return t[0]=r[0]+e[0]*a,t[1]=r[1]+e[1]*a,t[2]=r[2]+e[2]*a,t[3]=r[3]+e[3]*a,t[4]=r[4]+e[4]*a,t[5]=r[5]+e[5]*a,t}function w(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]}function A(r,e){var a=r[0],n=r[1],o=r[2],s=r[3],u=r[4],i=r[5],p=e[0],c=e[1],f=e[2],M=e[3],h=e[4],x=e[5];return Math.abs(a-p)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(n-c)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(o-f)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(s-M)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-h)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(h))&&Math.abs(i-x)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(x))}var E=c;exports.mul=E;var R=d;exports.sub=R;
},{"./common.js":"XJqx"}],"vtQf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=a,exports.fromMat4=n,exports.clone=e,exports.copy=o,exports.fromValues=s,exports.set=u,exports.identity=p,exports.transpose=i,exports.invert=M,exports.adjoint=c,exports.determinant=h,exports.multiply=f,exports.translate=x,exports.rotate=b,exports.scale=l,exports.fromTranslation=m,exports.fromRotation=v,exports.fromScaling=P,exports.fromMat2d=O,exports.fromQuat=d,exports.normalFromMat4=w,exports.projection=E,exports.str=y,exports.frob=S,exports.add=A,exports.subtract=j,exports.multiplyScalar=I,exports.multiplyScalarAndAdd=L,exports.exactEquals=N,exports.equals=R,exports.sub=exports.mul=void 0;var t=r(require("./common.js"));function r(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,a):{};n.get||n.set?Object.defineProperty(r,a,n):r[a]=t[a]}return r.default=t,r}function a(){var r=new t.ARRAY_TYPE(9);return t.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function n(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[4],t[4]=r[5],t[5]=r[6],t[6]=r[8],t[7]=r[9],t[8]=r[10],t}function e(r){var a=new t.ARRAY_TYPE(9);return a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[4]=r[4],a[5]=r[5],a[6]=r[6],a[7]=r[7],a[8]=r[8],a}function o(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t}function s(r,a,n,e,o,s,u,p,i){var M=new t.ARRAY_TYPE(9);return M[0]=r,M[1]=a,M[2]=n,M[3]=e,M[4]=o,M[5]=s,M[6]=u,M[7]=p,M[8]=i,M}function u(t,r,a,n,e,o,s,u,p,i){return t[0]=r,t[1]=a,t[2]=n,t[3]=e,t[4]=o,t[5]=s,t[6]=u,t[7]=p,t[8]=i,t}function p(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function i(t,r){if(t===r){var a=r[1],n=r[2],e=r[5];t[1]=r[3],t[2]=r[6],t[3]=a,t[5]=r[7],t[6]=n,t[7]=e}else t[0]=r[0],t[1]=r[3],t[2]=r[6],t[3]=r[1],t[4]=r[4],t[5]=r[7],t[6]=r[2],t[7]=r[5],t[8]=r[8];return t}function M(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],s=r[4],u=r[5],p=r[6],i=r[7],M=r[8],c=M*s-u*i,h=-M*o+u*p,f=i*o-s*p,x=a*c+n*h+e*f;return x?(x=1/x,t[0]=c*x,t[1]=(-M*n+e*i)*x,t[2]=(u*n-e*s)*x,t[3]=h*x,t[4]=(M*a-e*p)*x,t[5]=(-u*a+e*o)*x,t[6]=f*x,t[7]=(-i*a+n*p)*x,t[8]=(s*a-n*o)*x,t):null}function c(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],s=r[4],u=r[5],p=r[6],i=r[7],M=r[8];return t[0]=s*M-u*i,t[1]=e*i-n*M,t[2]=n*u-e*s,t[3]=u*p-o*M,t[4]=a*M-e*p,t[5]=e*o-a*u,t[6]=o*i-s*p,t[7]=n*p-a*i,t[8]=a*s-n*o,t}function h(t){var r=t[0],a=t[1],n=t[2],e=t[3],o=t[4],s=t[5],u=t[6],p=t[7],i=t[8];return r*(i*o-s*p)+a*(-i*e+s*u)+n*(p*e-o*u)}function f(t,r,a){var n=r[0],e=r[1],o=r[2],s=r[3],u=r[4],p=r[5],i=r[6],M=r[7],c=r[8],h=a[0],f=a[1],x=a[2],b=a[3],l=a[4],m=a[5],v=a[6],P=a[7],O=a[8];return t[0]=h*n+f*s+x*i,t[1]=h*e+f*u+x*M,t[2]=h*o+f*p+x*c,t[3]=b*n+l*s+m*i,t[4]=b*e+l*u+m*M,t[5]=b*o+l*p+m*c,t[6]=v*n+P*s+O*i,t[7]=v*e+P*u+O*M,t[8]=v*o+P*p+O*c,t}function x(t,r,a){var n=r[0],e=r[1],o=r[2],s=r[3],u=r[4],p=r[5],i=r[6],M=r[7],c=r[8],h=a[0],f=a[1];return t[0]=n,t[1]=e,t[2]=o,t[3]=s,t[4]=u,t[5]=p,t[6]=h*n+f*s+i,t[7]=h*e+f*u+M,t[8]=h*o+f*p+c,t}function b(t,r,a){var n=r[0],e=r[1],o=r[2],s=r[3],u=r[4],p=r[5],i=r[6],M=r[7],c=r[8],h=Math.sin(a),f=Math.cos(a);return t[0]=f*n+h*s,t[1]=f*e+h*u,t[2]=f*o+h*p,t[3]=f*s-h*n,t[4]=f*u-h*e,t[5]=f*p-h*o,t[6]=i,t[7]=M,t[8]=c,t}function l(t,r,a){var n=a[0],e=a[1];return t[0]=n*r[0],t[1]=n*r[1],t[2]=n*r[2],t[3]=e*r[3],t[4]=e*r[4],t[5]=e*r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t}function m(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=r[0],t[7]=r[1],t[8]=1,t}function v(t,r){var a=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=a,t[2]=0,t[3]=-a,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function P(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=0,t[4]=r[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function O(t,r){return t[0]=r[0],t[1]=r[1],t[2]=0,t[3]=r[2],t[4]=r[3],t[5]=0,t[6]=r[4],t[7]=r[5],t[8]=1,t}function d(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],s=a+a,u=n+n,p=e+e,i=a*s,M=n*s,c=n*u,h=e*s,f=e*u,x=e*p,b=o*s,l=o*u,m=o*p;return t[0]=1-c-x,t[3]=M-m,t[6]=h+l,t[1]=M+m,t[4]=1-i-x,t[7]=f-b,t[2]=h-l,t[5]=f+b,t[8]=1-i-c,t}function w(t,r){var a=r[0],n=r[1],e=r[2],o=r[3],s=r[4],u=r[5],p=r[6],i=r[7],M=r[8],c=r[9],h=r[10],f=r[11],x=r[12],b=r[13],l=r[14],m=r[15],v=a*u-n*s,P=a*p-e*s,O=a*i-o*s,d=n*p-e*u,w=n*i-o*u,E=e*i-o*p,y=M*b-c*x,S=M*l-h*x,A=M*m-f*x,j=c*l-h*b,I=c*m-f*b,L=h*m-f*l,N=v*L-P*I+O*j+d*A-w*S+E*y;return N?(N=1/N,t[0]=(u*L-p*I+i*j)*N,t[1]=(p*A-s*L-i*S)*N,t[2]=(s*I-u*A+i*y)*N,t[3]=(e*I-n*L-o*j)*N,t[4]=(a*L-e*A+o*S)*N,t[5]=(n*A-a*I-o*y)*N,t[6]=(b*E-l*w+m*d)*N,t[7]=(l*O-x*E-m*P)*N,t[8]=(x*w-b*O+m*v)*N,t):null}function E(t,r,a){return t[0]=2/r,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/a,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function y(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function S(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))}function A(t,r,a){return t[0]=r[0]+a[0],t[1]=r[1]+a[1],t[2]=r[2]+a[2],t[3]=r[3]+a[3],t[4]=r[4]+a[4],t[5]=r[5]+a[5],t[6]=r[6]+a[6],t[7]=r[7]+a[7],t[8]=r[8]+a[8],t}function j(t,r,a){return t[0]=r[0]-a[0],t[1]=r[1]-a[1],t[2]=r[2]-a[2],t[3]=r[3]-a[3],t[4]=r[4]-a[4],t[5]=r[5]-a[5],t[6]=r[6]-a[6],t[7]=r[7]-a[7],t[8]=r[8]-a[8],t}function I(t,r,a){return t[0]=r[0]*a,t[1]=r[1]*a,t[2]=r[2]*a,t[3]=r[3]*a,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=r[7]*a,t[8]=r[8]*a,t}function L(t,r,a,n){return t[0]=r[0]+a[0]*n,t[1]=r[1]+a[1]*n,t[2]=r[2]+a[2]*n,t[3]=r[3]+a[3]*n,t[4]=r[4]+a[4]*n,t[5]=r[5]+a[5]*n,t[6]=r[6]+a[6]*n,t[7]=r[7]+a[7]*n,t[8]=r[8]+a[8]*n,t}function N(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]&&t[6]===r[6]&&t[7]===r[7]&&t[8]===r[8]}function R(r,a){var n=r[0],e=r[1],o=r[2],s=r[3],u=r[4],p=r[5],i=r[6],M=r[7],c=r[8],h=a[0],f=a[1],x=a[2],b=a[3],l=a[4],m=a[5],v=a[6],P=a[7],O=a[8];return Math.abs(n-h)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(e-f)<=t.EPSILON*Math.max(1,Math.abs(e),Math.abs(f))&&Math.abs(o-x)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(s-b)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(u-l)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(l))&&Math.abs(p-m)<=t.EPSILON*Math.max(1,Math.abs(p),Math.abs(m))&&Math.abs(i-v)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(M-P)<=t.EPSILON*Math.max(1,Math.abs(M),Math.abs(P))&&Math.abs(c-O)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(O))}var Y=f;exports.mul=Y;var _=j;exports.sub=_;
},{"./common.js":"XJqx"}],"w3aR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=r,exports.clone=n,exports.copy=o,exports.fromValues=e,exports.set=s,exports.identity=h,exports.transpose=M,exports.invert=u,exports.adjoint=i,exports.determinant=p,exports.multiply=c,exports.translate=f,exports.scale=x,exports.rotate=b,exports.rotateX=l,exports.rotateY=v,exports.rotateZ=m,exports.fromTranslation=P,exports.fromScaling=O,exports.fromRotation=E,exports.fromXRotation=S,exports.fromYRotation=w,exports.fromZRotation=I,exports.fromRotationTranslation=L,exports.fromQuat2=N,exports.getTranslation=q,exports.getScaling=R,exports.getRotation=d,exports.fromRotationTranslationScale=g,exports.fromRotationTranslationScaleOrigin=A,exports.fromQuat=y,exports.frustum=Y,exports.perspective=T,exports.perspectiveFromFieldOfView=_,exports.ortho=j,exports.lookAt=D,exports.targetTo=F,exports.str=Q,exports.frob=V,exports.add=X,exports.subtract=Z,exports.multiplyScalar=k,exports.multiplyScalarAndAdd=z,exports.exactEquals=B,exports.equals=C,exports.sub=exports.mul=void 0;var t=a(require("./common.js"));function a(t){if(t&&t.__esModule)return t;var a={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(a,r,n):a[r]=t[r]}return a.default=t,a}function r(){var a=new t.ARRAY_TYPE(16);return t.ARRAY_TYPE!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a}function n(a){var r=new t.ARRAY_TYPE(16);return r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=a[3],r[4]=a[4],r[5]=a[5],r[6]=a[6],r[7]=a[7],r[8]=a[8],r[9]=a[9],r[10]=a[10],r[11]=a[11],r[12]=a[12],r[13]=a[13],r[14]=a[14],r[15]=a[15],r}function o(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t}function e(a,r,n,o,e,s,h,M,u,i,p,c,f,x,b,l){var v=new t.ARRAY_TYPE(16);return v[0]=a,v[1]=r,v[2]=n,v[3]=o,v[4]=e,v[5]=s,v[6]=h,v[7]=M,v[8]=u,v[9]=i,v[10]=p,v[11]=c,v[12]=f,v[13]=x,v[14]=b,v[15]=l,v}function s(t,a,r,n,o,e,s,h,M,u,i,p,c,f,x,b,l){return t[0]=a,t[1]=r,t[2]=n,t[3]=o,t[4]=e,t[5]=s,t[6]=h,t[7]=M,t[8]=u,t[9]=i,t[10]=p,t[11]=c,t[12]=f,t[13]=x,t[14]=b,t[15]=l,t}function h(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function M(t,a){if(t===a){var r=a[1],n=a[2],o=a[3],e=a[6],s=a[7],h=a[11];t[1]=a[4],t[2]=a[8],t[3]=a[12],t[4]=r,t[6]=a[9],t[7]=a[13],t[8]=n,t[9]=e,t[11]=a[14],t[12]=o,t[13]=s,t[14]=h}else t[0]=a[0],t[1]=a[4],t[2]=a[8],t[3]=a[12],t[4]=a[1],t[5]=a[5],t[6]=a[9],t[7]=a[13],t[8]=a[2],t[9]=a[6],t[10]=a[10],t[11]=a[14],t[12]=a[3],t[13]=a[7],t[14]=a[11],t[15]=a[15];return t}function u(t,a){var r=a[0],n=a[1],o=a[2],e=a[3],s=a[4],h=a[5],M=a[6],u=a[7],i=a[8],p=a[9],c=a[10],f=a[11],x=a[12],b=a[13],l=a[14],v=a[15],m=r*h-n*s,P=r*M-o*s,O=r*u-e*s,E=n*M-o*h,S=n*u-e*h,w=o*u-e*M,I=i*b-p*x,L=i*l-c*x,N=i*v-f*x,q=p*l-c*b,R=p*v-f*b,d=c*v-f*l,g=m*d-P*R+O*q+E*N-S*L+w*I;return g?(g=1/g,t[0]=(h*d-M*R+u*q)*g,t[1]=(o*R-n*d-e*q)*g,t[2]=(b*w-l*S+v*E)*g,t[3]=(c*S-p*w-f*E)*g,t[4]=(M*N-s*d-u*L)*g,t[5]=(r*d-o*N+e*L)*g,t[6]=(l*O-x*w-v*P)*g,t[7]=(i*w-c*O+f*P)*g,t[8]=(s*R-h*N+u*I)*g,t[9]=(n*N-r*R-e*I)*g,t[10]=(x*S-b*O+v*m)*g,t[11]=(p*O-i*S-f*m)*g,t[12]=(h*L-s*q-M*I)*g,t[13]=(r*q-n*L+o*I)*g,t[14]=(b*P-x*E-l*m)*g,t[15]=(i*E-p*P+c*m)*g,t):null}function i(t,a){var r=a[0],n=a[1],o=a[2],e=a[3],s=a[4],h=a[5],M=a[6],u=a[7],i=a[8],p=a[9],c=a[10],f=a[11],x=a[12],b=a[13],l=a[14],v=a[15];return t[0]=h*(c*v-f*l)-p*(M*v-u*l)+b*(M*f-u*c),t[1]=-(n*(c*v-f*l)-p*(o*v-e*l)+b*(o*f-e*c)),t[2]=n*(M*v-u*l)-h*(o*v-e*l)+b*(o*u-e*M),t[3]=-(n*(M*f-u*c)-h*(o*f-e*c)+p*(o*u-e*M)),t[4]=-(s*(c*v-f*l)-i*(M*v-u*l)+x*(M*f-u*c)),t[5]=r*(c*v-f*l)-i*(o*v-e*l)+x*(o*f-e*c),t[6]=-(r*(M*v-u*l)-s*(o*v-e*l)+x*(o*u-e*M)),t[7]=r*(M*f-u*c)-s*(o*f-e*c)+i*(o*u-e*M),t[8]=s*(p*v-f*b)-i*(h*v-u*b)+x*(h*f-u*p),t[9]=-(r*(p*v-f*b)-i*(n*v-e*b)+x*(n*f-e*p)),t[10]=r*(h*v-u*b)-s*(n*v-e*b)+x*(n*u-e*h),t[11]=-(r*(h*f-u*p)-s*(n*f-e*p)+i*(n*u-e*h)),t[12]=-(s*(p*l-c*b)-i*(h*l-M*b)+x*(h*c-M*p)),t[13]=r*(p*l-c*b)-i*(n*l-o*b)+x*(n*c-o*p),t[14]=-(r*(h*l-M*b)-s*(n*l-o*b)+x*(n*M-o*h)),t[15]=r*(h*c-M*p)-s*(n*c-o*p)+i*(n*M-o*h),t}function p(t){var a=t[0],r=t[1],n=t[2],o=t[3],e=t[4],s=t[5],h=t[6],M=t[7],u=t[8],i=t[9],p=t[10],c=t[11],f=t[12],x=t[13],b=t[14],l=t[15];return(a*s-r*e)*(p*l-c*b)-(a*h-n*e)*(i*l-c*x)+(a*M-o*e)*(i*b-p*x)+(r*h-n*s)*(u*l-c*f)-(r*M-o*s)*(u*b-p*f)+(n*M-o*h)*(u*x-i*f)}function c(t,a,r){var n=a[0],o=a[1],e=a[2],s=a[3],h=a[4],M=a[5],u=a[6],i=a[7],p=a[8],c=a[9],f=a[10],x=a[11],b=a[12],l=a[13],v=a[14],m=a[15],P=r[0],O=r[1],E=r[2],S=r[3];return t[0]=P*n+O*h+E*p+S*b,t[1]=P*o+O*M+E*c+S*l,t[2]=P*e+O*u+E*f+S*v,t[3]=P*s+O*i+E*x+S*m,P=r[4],O=r[5],E=r[6],S=r[7],t[4]=P*n+O*h+E*p+S*b,t[5]=P*o+O*M+E*c+S*l,t[6]=P*e+O*u+E*f+S*v,t[7]=P*s+O*i+E*x+S*m,P=r[8],O=r[9],E=r[10],S=r[11],t[8]=P*n+O*h+E*p+S*b,t[9]=P*o+O*M+E*c+S*l,t[10]=P*e+O*u+E*f+S*v,t[11]=P*s+O*i+E*x+S*m,P=r[12],O=r[13],E=r[14],S=r[15],t[12]=P*n+O*h+E*p+S*b,t[13]=P*o+O*M+E*c+S*l,t[14]=P*e+O*u+E*f+S*v,t[15]=P*s+O*i+E*x+S*m,t}function f(t,a,r){var n,o,e,s,h,M,u,i,p,c,f,x,b=r[0],l=r[1],v=r[2];return a===t?(t[12]=a[0]*b+a[4]*l+a[8]*v+a[12],t[13]=a[1]*b+a[5]*l+a[9]*v+a[13],t[14]=a[2]*b+a[6]*l+a[10]*v+a[14],t[15]=a[3]*b+a[7]*l+a[11]*v+a[15]):(n=a[0],o=a[1],e=a[2],s=a[3],h=a[4],M=a[5],u=a[6],i=a[7],p=a[8],c=a[9],f=a[10],x=a[11],t[0]=n,t[1]=o,t[2]=e,t[3]=s,t[4]=h,t[5]=M,t[6]=u,t[7]=i,t[8]=p,t[9]=c,t[10]=f,t[11]=x,t[12]=n*b+h*l+p*v+a[12],t[13]=o*b+M*l+c*v+a[13],t[14]=e*b+u*l+f*v+a[14],t[15]=s*b+i*l+x*v+a[15]),t}function x(t,a,r){var n=r[0],o=r[1],e=r[2];return t[0]=a[0]*n,t[1]=a[1]*n,t[2]=a[2]*n,t[3]=a[3]*n,t[4]=a[4]*o,t[5]=a[5]*o,t[6]=a[6]*o,t[7]=a[7]*o,t[8]=a[8]*e,t[9]=a[9]*e,t[10]=a[10]*e,t[11]=a[11]*e,t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t}function b(a,r,n,o){var e,s,h,M,u,i,p,c,f,x,b,l,v,m,P,O,E,S,w,I,L,N,q,R,d=o[0],g=o[1],A=o[2],y=Math.sqrt(d*d+g*g+A*A);return y<t.EPSILON?null:(d*=y=1/y,g*=y,A*=y,e=Math.sin(n),h=1-(s=Math.cos(n)),M=r[0],u=r[1],i=r[2],p=r[3],c=r[4],f=r[5],x=r[6],b=r[7],l=r[8],v=r[9],m=r[10],P=r[11],O=d*d*h+s,E=g*d*h+A*e,S=A*d*h-g*e,w=d*g*h-A*e,I=g*g*h+s,L=A*g*h+d*e,N=d*A*h+g*e,q=g*A*h-d*e,R=A*A*h+s,a[0]=M*O+c*E+l*S,a[1]=u*O+f*E+v*S,a[2]=i*O+x*E+m*S,a[3]=p*O+b*E+P*S,a[4]=M*w+c*I+l*L,a[5]=u*w+f*I+v*L,a[6]=i*w+x*I+m*L,a[7]=p*w+b*I+P*L,a[8]=M*N+c*q+l*R,a[9]=u*N+f*q+v*R,a[10]=i*N+x*q+m*R,a[11]=p*N+b*q+P*R,r!==a&&(a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15]),a)}function l(t,a,r){var n=Math.sin(r),o=Math.cos(r),e=a[4],s=a[5],h=a[6],M=a[7],u=a[8],i=a[9],p=a[10],c=a[11];return a!==t&&(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[4]=e*o+u*n,t[5]=s*o+i*n,t[6]=h*o+p*n,t[7]=M*o+c*n,t[8]=u*o-e*n,t[9]=i*o-s*n,t[10]=p*o-h*n,t[11]=c*o-M*n,t}function v(t,a,r){var n=Math.sin(r),o=Math.cos(r),e=a[0],s=a[1],h=a[2],M=a[3],u=a[8],i=a[9],p=a[10],c=a[11];return a!==t&&(t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[0]=e*o-u*n,t[1]=s*o-i*n,t[2]=h*o-p*n,t[3]=M*o-c*n,t[8]=e*n+u*o,t[9]=s*n+i*o,t[10]=h*n+p*o,t[11]=M*n+c*o,t}function m(t,a,r){var n=Math.sin(r),o=Math.cos(r),e=a[0],s=a[1],h=a[2],M=a[3],u=a[4],i=a[5],p=a[6],c=a[7];return a!==t&&(t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[0]=e*o+u*n,t[1]=s*o+i*n,t[2]=h*o+p*n,t[3]=M*o+c*n,t[4]=u*o-e*n,t[5]=i*o-s*n,t[6]=p*o-h*n,t[7]=c*o-M*n,t}function P(t,a){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t}function O(t,a){return t[0]=a[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=a[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function E(a,r,n){var o,e,s,h=n[0],M=n[1],u=n[2],i=Math.sqrt(h*h+M*M+u*u);return i<t.EPSILON?null:(h*=i=1/i,M*=i,u*=i,o=Math.sin(r),s=1-(e=Math.cos(r)),a[0]=h*h*s+e,a[1]=M*h*s+u*o,a[2]=u*h*s-M*o,a[3]=0,a[4]=h*M*s-u*o,a[5]=M*M*s+e,a[6]=u*M*s+h*o,a[7]=0,a[8]=h*u*s+M*o,a[9]=M*u*s-h*o,a[10]=u*u*s+e,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}function S(t,a){var r=Math.sin(a),n=Math.cos(a);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function w(t,a){var r=Math.sin(a),n=Math.cos(a);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function I(t,a){var r=Math.sin(a),n=Math.cos(a);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function L(t,a,r){var n=a[0],o=a[1],e=a[2],s=a[3],h=n+n,M=o+o,u=e+e,i=n*h,p=n*M,c=n*u,f=o*M,x=o*u,b=e*u,l=s*h,v=s*M,m=s*u;return t[0]=1-(f+b),t[1]=p+m,t[2]=c-v,t[3]=0,t[4]=p-m,t[5]=1-(i+b),t[6]=x+l,t[7]=0,t[8]=c+v,t[9]=x-l,t[10]=1-(i+f),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function N(a,r){var n=new t.ARRAY_TYPE(3),o=-r[0],e=-r[1],s=-r[2],h=r[3],M=r[4],u=r[5],i=r[6],p=r[7],c=o*o+e*e+s*s+h*h;return c>0?(n[0]=2*(M*h+p*o+u*s-i*e)/c,n[1]=2*(u*h+p*e+i*o-M*s)/c,n[2]=2*(i*h+p*s+M*e-u*o)/c):(n[0]=2*(M*h+p*o+u*s-i*e),n[1]=2*(u*h+p*e+i*o-M*s),n[2]=2*(i*h+p*s+M*e-u*o)),L(a,r,n),a}function q(t,a){return t[0]=a[12],t[1]=a[13],t[2]=a[14],t}function R(t,a){var r=a[0],n=a[1],o=a[2],e=a[4],s=a[5],h=a[6],M=a[8],u=a[9],i=a[10];return t[0]=Math.sqrt(r*r+n*n+o*o),t[1]=Math.sqrt(e*e+s*s+h*h),t[2]=Math.sqrt(M*M+u*u+i*i),t}function d(t,a){var r=a[0]+a[5]+a[10],n=0;return r>0?(n=2*Math.sqrt(r+1),t[3]=.25*n,t[0]=(a[6]-a[9])/n,t[1]=(a[8]-a[2])/n,t[2]=(a[1]-a[4])/n):a[0]>a[5]&&a[0]>a[10]?(n=2*Math.sqrt(1+a[0]-a[5]-a[10]),t[3]=(a[6]-a[9])/n,t[0]=.25*n,t[1]=(a[1]+a[4])/n,t[2]=(a[8]+a[2])/n):a[5]>a[10]?(n=2*Math.sqrt(1+a[5]-a[0]-a[10]),t[3]=(a[8]-a[2])/n,t[0]=(a[1]+a[4])/n,t[1]=.25*n,t[2]=(a[6]+a[9])/n):(n=2*Math.sqrt(1+a[10]-a[0]-a[5]),t[3]=(a[1]-a[4])/n,t[0]=(a[8]+a[2])/n,t[1]=(a[6]+a[9])/n,t[2]=.25*n),t}function g(t,a,r,n){var o=a[0],e=a[1],s=a[2],h=a[3],M=o+o,u=e+e,i=s+s,p=o*M,c=o*u,f=o*i,x=e*u,b=e*i,l=s*i,v=h*M,m=h*u,P=h*i,O=n[0],E=n[1],S=n[2];return t[0]=(1-(x+l))*O,t[1]=(c+P)*O,t[2]=(f-m)*O,t[3]=0,t[4]=(c-P)*E,t[5]=(1-(p+l))*E,t[6]=(b+v)*E,t[7]=0,t[8]=(f+m)*S,t[9]=(b-v)*S,t[10]=(1-(p+x))*S,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function A(t,a,r,n,o){var e=a[0],s=a[1],h=a[2],M=a[3],u=e+e,i=s+s,p=h+h,c=e*u,f=e*i,x=e*p,b=s*i,l=s*p,v=h*p,m=M*u,P=M*i,O=M*p,E=n[0],S=n[1],w=n[2],I=o[0],L=o[1],N=o[2],q=(1-(b+v))*E,R=(f+O)*E,d=(x-P)*E,g=(f-O)*S,A=(1-(c+v))*S,y=(l+m)*S,Y=(x+P)*w,T=(l-m)*w,_=(1-(c+b))*w;return t[0]=q,t[1]=R,t[2]=d,t[3]=0,t[4]=g,t[5]=A,t[6]=y,t[7]=0,t[8]=Y,t[9]=T,t[10]=_,t[11]=0,t[12]=r[0]+I-(q*I+g*L+Y*N),t[13]=r[1]+L-(R*I+A*L+T*N),t[14]=r[2]+N-(d*I+y*L+_*N),t[15]=1,t}function y(t,a){var r=a[0],n=a[1],o=a[2],e=a[3],s=r+r,h=n+n,M=o+o,u=r*s,i=n*s,p=n*h,c=o*s,f=o*h,x=o*M,b=e*s,l=e*h,v=e*M;return t[0]=1-p-x,t[1]=i+v,t[2]=c-l,t[3]=0,t[4]=i-v,t[5]=1-u-x,t[6]=f+b,t[7]=0,t[8]=c+l,t[9]=f-b,t[10]=1-u-p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Y(t,a,r,n,o,e,s){var h=1/(r-a),M=1/(o-n),u=1/(e-s);return t[0]=2*e*h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*e*M,t[6]=0,t[7]=0,t[8]=(r+a)*h,t[9]=(o+n)*M,t[10]=(s+e)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*e*2*u,t[15]=0,t}function T(t,a,r,n,o){var e,s=1/Math.tan(a/2);return t[0]=s/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(e=1/(n-o),t[10]=(o+n)*e,t[14]=2*o*n*e):(t[10]=-1,t[14]=-2*n),t}function _(t,a,r,n){var o=Math.tan(a.upDegrees*Math.PI/180),e=Math.tan(a.downDegrees*Math.PI/180),s=Math.tan(a.leftDegrees*Math.PI/180),h=Math.tan(a.rightDegrees*Math.PI/180),M=2/(s+h),u=2/(o+e);return t[0]=M,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(s-h)*M*.5,t[9]=(o-e)*u*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function j(t,a,r,n,o,e,s){var h=1/(a-r),M=1/(n-o),u=1/(e-s);return t[0]=-2*h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*M,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(a+r)*h,t[13]=(o+n)*M,t[14]=(s+e)*u,t[15]=1,t}function D(a,r,n,o){var e,s,M,u,i,p,c,f,x,b,l=r[0],v=r[1],m=r[2],P=o[0],O=o[1],E=o[2],S=n[0],w=n[1],I=n[2];return Math.abs(l-S)<t.EPSILON&&Math.abs(v-w)<t.EPSILON&&Math.abs(m-I)<t.EPSILON?h(a):(c=l-S,f=v-w,x=m-I,e=O*(x*=b=1/Math.sqrt(c*c+f*f+x*x))-E*(f*=b),s=E*(c*=b)-P*x,M=P*f-O*c,(b=Math.sqrt(e*e+s*s+M*M))?(e*=b=1/b,s*=b,M*=b):(e=0,s=0,M=0),u=f*M-x*s,i=x*e-c*M,p=c*s-f*e,(b=Math.sqrt(u*u+i*i+p*p))?(u*=b=1/b,i*=b,p*=b):(u=0,i=0,p=0),a[0]=e,a[1]=u,a[2]=c,a[3]=0,a[4]=s,a[5]=i,a[6]=f,a[7]=0,a[8]=M,a[9]=p,a[10]=x,a[11]=0,a[12]=-(e*l+s*v+M*m),a[13]=-(u*l+i*v+p*m),a[14]=-(c*l+f*v+x*m),a[15]=1,a)}function F(t,a,r,n){var o=a[0],e=a[1],s=a[2],h=n[0],M=n[1],u=n[2],i=o-r[0],p=e-r[1],c=s-r[2],f=i*i+p*p+c*c;f>0&&(i*=f=1/Math.sqrt(f),p*=f,c*=f);var x=M*c-u*p,b=u*i-h*c,l=h*p-M*i;return(f=x*x+b*b+l*l)>0&&(x*=f=1/Math.sqrt(f),b*=f,l*=f),t[0]=x,t[1]=b,t[2]=l,t[3]=0,t[4]=p*l-c*b,t[5]=c*x-i*l,t[6]=i*b-p*x,t[7]=0,t[8]=i,t[9]=p,t[10]=c,t[11]=0,t[12]=o,t[13]=e,t[14]=s,t[15]=1,t}function Q(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function V(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function X(t,a,r){return t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t[3]=a[3]+r[3],t[4]=a[4]+r[4],t[5]=a[5]+r[5],t[6]=a[6]+r[6],t[7]=a[7]+r[7],t[8]=a[8]+r[8],t[9]=a[9]+r[9],t[10]=a[10]+r[10],t[11]=a[11]+r[11],t[12]=a[12]+r[12],t[13]=a[13]+r[13],t[14]=a[14]+r[14],t[15]=a[15]+r[15],t}function Z(t,a,r){return t[0]=a[0]-r[0],t[1]=a[1]-r[1],t[2]=a[2]-r[2],t[3]=a[3]-r[3],t[4]=a[4]-r[4],t[5]=a[5]-r[5],t[6]=a[6]-r[6],t[7]=a[7]-r[7],t[8]=a[8]-r[8],t[9]=a[9]-r[9],t[10]=a[10]-r[10],t[11]=a[11]-r[11],t[12]=a[12]-r[12],t[13]=a[13]-r[13],t[14]=a[14]-r[14],t[15]=a[15]-r[15],t}function k(t,a,r){return t[0]=a[0]*r,t[1]=a[1]*r,t[2]=a[2]*r,t[3]=a[3]*r,t[4]=a[4]*r,t[5]=a[5]*r,t[6]=a[6]*r,t[7]=a[7]*r,t[8]=a[8]*r,t[9]=a[9]*r,t[10]=a[10]*r,t[11]=a[11]*r,t[12]=a[12]*r,t[13]=a[13]*r,t[14]=a[14]*r,t[15]=a[15]*r,t}function z(t,a,r,n){return t[0]=a[0]+r[0]*n,t[1]=a[1]+r[1]*n,t[2]=a[2]+r[2]*n,t[3]=a[3]+r[3]*n,t[4]=a[4]+r[4]*n,t[5]=a[5]+r[5]*n,t[6]=a[6]+r[6]*n,t[7]=a[7]+r[7]*n,t[8]=a[8]+r[8]*n,t[9]=a[9]+r[9]*n,t[10]=a[10]+r[10]*n,t[11]=a[11]+r[11]*n,t[12]=a[12]+r[12]*n,t[13]=a[13]+r[13]*n,t[14]=a[14]+r[14]*n,t[15]=a[15]+r[15]*n,t}function B(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]&&t[4]===a[4]&&t[5]===a[5]&&t[6]===a[6]&&t[7]===a[7]&&t[8]===a[8]&&t[9]===a[9]&&t[10]===a[10]&&t[11]===a[11]&&t[12]===a[12]&&t[13]===a[13]&&t[14]===a[14]&&t[15]===a[15]}function C(a,r){var n=a[0],o=a[1],e=a[2],s=a[3],h=a[4],M=a[5],u=a[6],i=a[7],p=a[8],c=a[9],f=a[10],x=a[11],b=a[12],l=a[13],v=a[14],m=a[15],P=r[0],O=r[1],E=r[2],S=r[3],w=r[4],I=r[5],L=r[6],N=r[7],q=r[8],R=r[9],d=r[10],g=r[11],A=r[12],y=r[13],Y=r[14],T=r[15];return Math.abs(n-P)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(P))&&Math.abs(o-O)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(O))&&Math.abs(e-E)<=t.EPSILON*Math.max(1,Math.abs(e),Math.abs(E))&&Math.abs(s-S)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(h-w)<=t.EPSILON*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(M-I)<=t.EPSILON*Math.max(1,Math.abs(M),Math.abs(I))&&Math.abs(u-L)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(L))&&Math.abs(i-N)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(N))&&Math.abs(p-q)<=t.EPSILON*Math.max(1,Math.abs(p),Math.abs(q))&&Math.abs(c-R)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(R))&&Math.abs(f-d)<=t.EPSILON*Math.max(1,Math.abs(f),Math.abs(d))&&Math.abs(x-g)<=t.EPSILON*Math.max(1,Math.abs(x),Math.abs(g))&&Math.abs(b-A)<=t.EPSILON*Math.max(1,Math.abs(b),Math.abs(A))&&Math.abs(l-y)<=t.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(v-Y)<=t.EPSILON*Math.max(1,Math.abs(v),Math.abs(Y))&&Math.abs(m-T)<=t.EPSILON*Math.max(1,Math.abs(m),Math.abs(T))}var G=c;exports.mul=G;var H=Z;exports.sub=H;
},{"./common.js":"XJqx"}],"AWBd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=e,exports.clone=n,exports.length=o,exports.fromValues=a,exports.copy=s,exports.set=u,exports.add=i,exports.subtract=c,exports.multiply=p,exports.divide=x,exports.ceil=f,exports.floor=h,exports.min=M,exports.max=v,exports.round=l,exports.scale=d,exports.scaleAndAdd=m,exports.distance=b,exports.squaredDistance=P,exports.squaredLength=O,exports.negate=q,exports.inverse=A,exports.normalize=y,exports.dot=E,exports.cross=R,exports.lerp=g,exports.hermite=Y,exports.bezier=_,exports.random=j,exports.transformMat4=D,exports.transformMat3=w,exports.transformQuat=L,exports.rotateX=I,exports.rotateY=N,exports.rotateZ=T,exports.angle=z,exports.zero=S,exports.str=F,exports.exactEquals=Q,exports.equals=V,exports.forEach=exports.sqrLen=exports.len=exports.sqrDist=exports.dist=exports.div=exports.mul=exports.sub=void 0;var t=r(require("./common.js"));function r(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,e):{};n.get||n.set?Object.defineProperty(r,e,n):r[e]=t[e]}return r.default=t,r}function e(){var r=new t.ARRAY_TYPE(3);return t.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function n(r){var e=new t.ARRAY_TYPE(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function o(t){var r=t[0],e=t[1],n=t[2];return Math.sqrt(r*r+e*e+n*n)}function a(r,e,n){var o=new t.ARRAY_TYPE(3);return o[0]=r,o[1]=e,o[2]=n,o}function s(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t}function u(t,r,e,n){return t[0]=r,t[1]=e,t[2]=n,t}function i(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t}function c(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t}function p(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t[2]=r[2]*e[2],t}function x(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t[2]=r[2]/e[2],t}function f(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t[2]=Math.ceil(r[2]),t}function h(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t[2]=Math.floor(r[2]),t}function M(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t[2]=Math.min(r[2],e[2]),t}function v(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t[2]=Math.max(r[2],e[2]),t}function l(t,r){return t[0]=Math.round(r[0]),t[1]=Math.round(r[1]),t[2]=Math.round(r[2]),t}function d(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t}function m(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t}function b(t,r){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2];return Math.sqrt(e*e+n*n+o*o)}function P(t,r){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2];return e*e+n*n+o*o}function O(t){var r=t[0],e=t[1],n=t[2];return r*r+e*e+n*n}function q(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t}function A(t,r){return t[0]=1/r[0],t[1]=1/r[1],t[2]=1/r[2],t}function y(t,r){var e=r[0],n=r[1],o=r[2],a=e*e+n*n+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=r[0]*a,t[1]=r[1]*a,t[2]=r[2]*a,t}function E(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]}function R(t,r,e){var n=r[0],o=r[1],a=r[2],s=e[0],u=e[1],i=e[2];return t[0]=o*i-a*u,t[1]=a*s-n*i,t[2]=n*u-o*s,t}function g(t,r,e,n){var o=r[0],a=r[1],s=r[2];return t[0]=o+n*(e[0]-o),t[1]=a+n*(e[1]-a),t[2]=s+n*(e[2]-s),t}function Y(t,r,e,n,o,a){var s=a*a,u=s*(2*a-3)+1,i=s*(a-2)+a,c=s*(a-1),p=s*(3-2*a);return t[0]=r[0]*u+e[0]*i+n[0]*c+o[0]*p,t[1]=r[1]*u+e[1]*i+n[1]*c+o[1]*p,t[2]=r[2]*u+e[2]*i+n[2]*c+o[2]*p,t}function _(t,r,e,n,o,a){var s=1-a,u=s*s,i=a*a,c=u*s,p=3*a*u,x=3*i*s,f=i*a;return t[0]=r[0]*c+e[0]*p+n[0]*x+o[0]*f,t[1]=r[1]*c+e[1]*p+n[1]*x+o[1]*f,t[2]=r[2]*c+e[2]*p+n[2]*x+o[2]*f,t}function j(r,e){e=e||1;var n=2*t.RANDOM()*Math.PI,o=2*t.RANDOM()-1,a=Math.sqrt(1-o*o)*e;return r[0]=Math.cos(n)*a,r[1]=Math.sin(n)*a,r[2]=o*e,r}function D(t,r,e){var n=r[0],o=r[1],a=r[2],s=e[3]*n+e[7]*o+e[11]*a+e[15];return s=s||1,t[0]=(e[0]*n+e[4]*o+e[8]*a+e[12])/s,t[1]=(e[1]*n+e[5]*o+e[9]*a+e[13])/s,t[2]=(e[2]*n+e[6]*o+e[10]*a+e[14])/s,t}function w(t,r,e){var n=r[0],o=r[1],a=r[2];return t[0]=n*e[0]+o*e[3]+a*e[6],t[1]=n*e[1]+o*e[4]+a*e[7],t[2]=n*e[2]+o*e[5]+a*e[8],t}function L(t,r,e){var n=e[0],o=e[1],a=e[2],s=e[3],u=r[0],i=r[1],c=r[2],p=o*c-a*i,x=a*u-n*c,f=n*i-o*u,h=o*f-a*x,M=a*p-n*f,v=n*x-o*p,l=2*s;return p*=l,x*=l,f*=l,h*=2,M*=2,v*=2,t[0]=u+p+h,t[1]=i+x+M,t[2]=c+f+v,t}function I(t,r,e,n){var o=[],a=[];return o[0]=r[0]-e[0],o[1]=r[1]-e[1],o[2]=r[2]-e[2],a[0]=o[0],a[1]=o[1]*Math.cos(n)-o[2]*Math.sin(n),a[2]=o[1]*Math.sin(n)+o[2]*Math.cos(n),t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t}function N(t,r,e,n){var o=[],a=[];return o[0]=r[0]-e[0],o[1]=r[1]-e[1],o[2]=r[2]-e[2],a[0]=o[2]*Math.sin(n)+o[0]*Math.cos(n),a[1]=o[1],a[2]=o[2]*Math.cos(n)-o[0]*Math.sin(n),t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t}function T(t,r,e,n){var o=[],a=[];return o[0]=r[0]-e[0],o[1]=r[1]-e[1],o[2]=r[2]-e[2],a[0]=o[0]*Math.cos(n)-o[1]*Math.sin(n),a[1]=o[0]*Math.sin(n)+o[1]*Math.cos(n),a[2]=o[2],t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t}function z(t,r){var e=a(t[0],t[1],t[2]),n=a(r[0],r[1],r[2]);y(e,e),y(n,n);var o=E(e,n);return o>1?0:o<-1?Math.PI:Math.acos(o)}function S(t){return t[0]=0,t[1]=0,t[2]=0,t}function F(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Q(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]}function V(r,e){var n=r[0],o=r[1],a=r[2],s=e[0],u=e[1],i=e[2];return Math.abs(n-s)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-u)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(a-i)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(i))}var X=c;exports.sub=X;var Z=p;exports.mul=Z;var k=x;exports.div=k;var B=b;exports.dist=B;var C=P;exports.sqrDist=C;var G=o;exports.len=G;var H=O;exports.sqrLen=H;var J=function(){var t=e();return function(r,e,n,o,a,s){var u,i;for(e||(e=3),n||(n=0),i=o?Math.min(o*e+n,r.length):r.length,u=n;u<i;u+=e)t[0]=r[u],t[1]=r[u+1],t[2]=r[u+2],a(t,t,s),r[u]=t[0],r[u+1]=t[1],r[u+2]=t[2];return r}}();exports.forEach=J;
},{"./common.js":"XJqx"}],"9+zW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=e,exports.clone=n,exports.fromValues=o,exports.copy=a,exports.set=s,exports.add=u,exports.subtract=i,exports.multiply=c,exports.divide=p,exports.ceil=x,exports.floor=f,exports.min=h,exports.max=M,exports.round=l,exports.scale=v,exports.scaleAndAdd=d,exports.distance=m,exports.squaredDistance=b,exports.length=O,exports.squaredLength=A,exports.negate=P,exports.inverse=q,exports.normalize=R,exports.dot=E,exports.cross=y,exports.lerp=D,exports.random=g,exports.transformMat4=w,exports.transformQuat=N,exports.zero=Y,exports.str=_,exports.exactEquals=j,exports.equals=L,exports.forEach=exports.sqrLen=exports.len=exports.sqrDist=exports.dist=exports.div=exports.mul=exports.sub=void 0;var t=r(require("./common.js"));function r(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,e):{};n.get||n.set?Object.defineProperty(r,e,n):r[e]=t[e]}return r.default=t,r}function e(){var r=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function n(r){var e=new t.ARRAY_TYPE(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function o(r,e,n,o){var a=new t.ARRAY_TYPE(4);return a[0]=r,a[1]=e,a[2]=n,a[3]=o,a}function a(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t}function s(t,r,e,n,o){return t[0]=r,t[1]=e,t[2]=n,t[3]=o,t}function u(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t}function i(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t[3]=r[3]-e[3],t}function c(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t[2]=r[2]*e[2],t[3]=r[3]*e[3],t}function p(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t[2]=r[2]/e[2],t[3]=r[3]/e[3],t}function x(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t[2]=Math.ceil(r[2]),t[3]=Math.ceil(r[3]),t}function f(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t[2]=Math.floor(r[2]),t[3]=Math.floor(r[3]),t}function h(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t[2]=Math.min(r[2],e[2]),t[3]=Math.min(r[3],e[3]),t}function M(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t[2]=Math.max(r[2],e[2]),t[3]=Math.max(r[3],e[3]),t}function l(t,r){return t[0]=Math.round(r[0]),t[1]=Math.round(r[1]),t[2]=Math.round(r[2]),t[3]=Math.round(r[3]),t}function v(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t}function d(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t[3]=r[3]+e[3]*n,t}function m(t,r){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2],a=r[3]-t[3];return Math.sqrt(e*e+n*n+o*o+a*a)}function b(t,r){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2],a=r[3]-t[3];return e*e+n*n+o*o+a*a}function O(t){var r=t[0],e=t[1],n=t[2],o=t[3];return Math.sqrt(r*r+e*e+n*n+o*o)}function A(t){var r=t[0],e=t[1],n=t[2],o=t[3];return r*r+e*e+n*n+o*o}function P(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=-r[3],t}function q(t,r){return t[0]=1/r[0],t[1]=1/r[1],t[2]=1/r[2],t[3]=1/r[3],t}function R(t,r){var e=r[0],n=r[1],o=r[2],a=r[3],s=e*e+n*n+o*o+a*a;return s>0&&(s=1/Math.sqrt(s)),t[0]=e*s,t[1]=n*s,t[2]=o*s,t[3]=a*s,t}function E(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]+t[3]*r[3]}function y(t,r,e,n){var o=e[0]*n[1]-e[1]*n[0],a=e[0]*n[2]-e[2]*n[0],s=e[0]*n[3]-e[3]*n[0],u=e[1]*n[2]-e[2]*n[1],i=e[1]*n[3]-e[3]*n[1],c=e[2]*n[3]-e[3]*n[2],p=r[0],x=r[1],f=r[2],h=r[3];return t[0]=x*c-f*i+h*u,t[1]=-p*c+f*s-h*a,t[2]=p*i-x*s+h*o,t[3]=-p*u+x*a-f*o,t}function D(t,r,e,n){var o=r[0],a=r[1],s=r[2],u=r[3];return t[0]=o+n*(e[0]-o),t[1]=a+n*(e[1]-a),t[2]=s+n*(e[2]-s),t[3]=u+n*(e[3]-u),t}function g(r,e){var n,o,a,s,u,i;e=e||1;do{u=(n=2*t.RANDOM()-1)*n+(o=2*t.RANDOM()-1)*o}while(u>=1);do{i=(a=2*t.RANDOM()-1)*a+(s=2*t.RANDOM()-1)*s}while(i>=1);var c=Math.sqrt((1-u)/i);return r[0]=e*n,r[1]=e*o,r[2]=e*a*c,r[3]=e*s*c,r}function w(t,r,e){var n=r[0],o=r[1],a=r[2],s=r[3];return t[0]=e[0]*n+e[4]*o+e[8]*a+e[12]*s,t[1]=e[1]*n+e[5]*o+e[9]*a+e[13]*s,t[2]=e[2]*n+e[6]*o+e[10]*a+e[14]*s,t[3]=e[3]*n+e[7]*o+e[11]*a+e[15]*s,t}function N(t,r,e){var n=r[0],o=r[1],a=r[2],s=e[0],u=e[1],i=e[2],c=e[3],p=c*n+u*a-i*o,x=c*o+i*n-s*a,f=c*a+s*o-u*n,h=-s*n-u*o-i*a;return t[0]=p*c+h*-s+x*-i-f*-u,t[1]=x*c+h*-u+f*-s-p*-i,t[2]=f*c+h*-i+p*-u-x*-s,t[3]=r[3],t}function Y(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function _(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function j(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]}function L(r,e){var n=r[0],o=r[1],a=r[2],s=r[3],u=e[0],i=e[1],c=e[2],p=e[3];return Math.abs(n-u)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(o-i)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(i))&&Math.abs(a-c)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(s-p)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))}var I=i;exports.sub=I;var S=c;exports.mul=S;var T=p;exports.div=T;var z=m;exports.dist=z;var F=b;exports.sqrDist=F;var Q=O;exports.len=Q;var V=A;exports.sqrLen=V;var k=function(){var t=e();return function(r,e,n,o,a,s){var u,i;for(e||(e=4),n||(n=0),i=o?Math.min(o*e+n,r.length):r.length,u=n;u<i;u+=e)t[0]=r[u],t[1]=r[u+1],t[2]=r[u+2],t[3]=r[u+3],a(t,t,s),r[u]=t[0],r[u+1]=t[1],r[u+2]=t[2],r[u+3]=t[3];return r}}();exports.forEach=k;
},{"./common.js":"XJqx"}],"1KdR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=a,exports.identity=n,exports.setAxisAngle=u,exports.getAxisAngle=p,exports.multiply=c,exports.rotateX=i,exports.rotateY=x,exports.rotateZ=l,exports.calculateW=v,exports.slerp=h,exports.random=M,exports.invert=f,exports.conjugate=q,exports.fromMat3=d,exports.fromEuler=m,exports.str=P,exports.setAxes=exports.sqlerp=exports.rotationTo=exports.equals=exports.exactEquals=exports.normalize=exports.sqrLen=exports.squaredLength=exports.len=exports.length=exports.lerp=exports.dot=exports.scale=exports.mul=exports.add=exports.set=exports.copy=exports.fromValues=exports.clone=void 0;var r=s(require("./common.js")),t=s(require("./mat3.js")),e=s(require("./vec3.js")),o=s(require("./vec4.js"));function s(r){if(r&&r.__esModule)return r;var t={};if(null!=r)for(var e in r)if(Object.prototype.hasOwnProperty.call(r,e)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,e):{};o.get||o.set?Object.defineProperty(t,e,o):t[e]=r[e]}return t.default=r,t}function a(){var t=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function n(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function u(r,t,e){e*=.5;var o=Math.sin(e);return r[0]=o*t[0],r[1]=o*t[1],r[2]=o*t[2],r[3]=Math.cos(e),r}function p(t,e){var o=2*Math.acos(e[3]),s=Math.sin(o/2);return s>r.EPSILON?(t[0]=e[0]/s,t[1]=e[1]/s,t[2]=e[2]/s):(t[0]=1,t[1]=0,t[2]=0),o}function c(r,t,e){var o=t[0],s=t[1],a=t[2],n=t[3],u=e[0],p=e[1],c=e[2],i=e[3];return r[0]=o*i+n*u+s*c-a*p,r[1]=s*i+n*p+a*u-o*c,r[2]=a*i+n*c+o*p-s*u,r[3]=n*i-o*u-s*p-a*c,r}function i(r,t,e){e*=.5;var o=t[0],s=t[1],a=t[2],n=t[3],u=Math.sin(e),p=Math.cos(e);return r[0]=o*p+n*u,r[1]=s*p+a*u,r[2]=a*p-s*u,r[3]=n*p-o*u,r}function x(r,t,e){e*=.5;var o=t[0],s=t[1],a=t[2],n=t[3],u=Math.sin(e),p=Math.cos(e);return r[0]=o*p-a*u,r[1]=s*p+n*u,r[2]=a*p+o*u,r[3]=n*p-s*u,r}function l(r,t,e){e*=.5;var o=t[0],s=t[1],a=t[2],n=t[3],u=Math.sin(e),p=Math.cos(e);return r[0]=o*p+s*u,r[1]=s*p-o*u,r[2]=a*p+n*u,r[3]=n*p-a*u,r}function v(r,t){var e=t[0],o=t[1],s=t[2];return r[0]=e,r[1]=o,r[2]=s,r[3]=Math.sqrt(Math.abs(1-e*e-o*o-s*s)),r}function h(t,e,o,s){var a,n,u,p,c,i=e[0],x=e[1],l=e[2],v=e[3],h=o[0],M=o[1],f=o[2],q=o[3];return(n=i*h+x*M+l*f+v*q)<0&&(n=-n,h=-h,M=-M,f=-f,q=-q),1-n>r.EPSILON?(a=Math.acos(n),u=Math.sin(a),p=Math.sin((1-s)*a)/u,c=Math.sin(s*a)/u):(p=1-s,c=s),t[0]=p*i+c*h,t[1]=p*x+c*M,t[2]=p*l+c*f,t[3]=p*v+c*q,t}function M(t){var e=r.RANDOM(),o=r.RANDOM(),s=r.RANDOM(),a=Math.sqrt(1-e),n=Math.sqrt(e);return t[0]=a*Math.sin(2*Math.PI*o),t[1]=a*Math.cos(2*Math.PI*o),t[2]=n*Math.sin(2*Math.PI*s),t[3]=n*Math.cos(2*Math.PI*s),t}function f(r,t){var e=t[0],o=t[1],s=t[2],a=t[3],n=e*e+o*o+s*s+a*a,u=n?1/n:0;return r[0]=-e*u,r[1]=-o*u,r[2]=-s*u,r[3]=a*u,r}function q(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=t[3],r}function d(r,t){var e,o=t[0]+t[4]+t[8];if(o>0)e=Math.sqrt(o+1),r[3]=.5*e,e=.5/e,r[0]=(t[5]-t[7])*e,r[1]=(t[6]-t[2])*e,r[2]=(t[1]-t[3])*e;else{var s=0;t[4]>t[0]&&(s=1),t[8]>t[3*s+s]&&(s=2);var a=(s+1)%3,n=(s+2)%3;e=Math.sqrt(t[3*s+s]-t[3*a+a]-t[3*n+n]+1),r[s]=.5*e,e=.5/e,r[3]=(t[3*a+n]-t[3*n+a])*e,r[a]=(t[3*a+s]+t[3*s+a])*e,r[n]=(t[3*n+s]+t[3*s+n])*e}return r}function m(r,t,e,o){var s=.5*Math.PI/180;t*=s,e*=s,o*=s;var a=Math.sin(t),n=Math.cos(t),u=Math.sin(e),p=Math.cos(e),c=Math.sin(o),i=Math.cos(o);return r[0]=a*p*i-n*u*c,r[1]=n*u*i+a*p*c,r[2]=n*p*c-a*u*i,r[3]=n*p*i+a*u*c,r}function P(r){return"quat("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"}var A=o.clone;exports.clone=A;var O=o.fromValues;exports.fromValues=O;var g=o.copy;exports.copy=g;var y=o.set;exports.set=y;var j=o.add;exports.add=j;var E=c;exports.mul=E;var I=o.scale;exports.scale=I;var b=o.dot;exports.dot=b;var L=o.lerp;exports.lerp=L;var R=o.length;exports.length=R;var _=R;exports.len=_;var D=o.squaredLength;exports.squaredLength=D;var N=D;exports.sqrLen=N;var V=o.normalize;exports.normalize=V;var Y=o.exactEquals;exports.exactEquals=Y;var w=o.equals;exports.equals=w;var z=function(){var r=e.create(),t=e.fromValues(1,0,0),o=e.fromValues(0,1,0);return function(s,a,n){var p=e.dot(a,n);return p<-.999999?(e.cross(r,t,a),e.len(r)<1e-6&&e.cross(r,o,a),e.normalize(r,r),u(s,r,Math.PI),s):p>.999999?(s[0]=0,s[1]=0,s[2]=0,s[3]=1,s):(e.cross(r,a,n),s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=1+p,V(s,s))}}();exports.rotationTo=z;var T=function(){var r=a(),t=a();return function(e,o,s,a,n,u){return h(r,o,n,u),h(t,s,a,u),h(e,r,t,2*u*(1-u)),e}}();exports.sqlerp=T;var S=function(){var r=t.create();return function(t,e,o,s){return r[0]=o[0],r[3]=o[1],r[6]=o[2],r[1]=s[0],r[4]=s[1],r[7]=s[2],r[2]=-e[0],r[5]=-e[1],r[8]=-e[2],V(t,d(t,r))}}();exports.setAxes=S;
},{"./common.js":"XJqx","./mat3.js":"vtQf","./vec3.js":"AWBd","./vec4.js":"9+zW"}],"6buG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=n,exports.clone=o,exports.fromValues=s,exports.fromRotationTranslationValues=u,exports.fromRotationTranslation=p,exports.fromTranslation=i,exports.fromRotation=x,exports.fromMat4=c,exports.copy=f,exports.identity=h,exports.set=M,exports.getDual=l,exports.setDual=P,exports.getTranslation=m,exports.translate=R,exports.rotateX=d,exports.rotateY=O,exports.rotateZ=g,exports.rotateByQuatAppend=A,exports.rotateByQuatPrepend=E,exports.rotateAroundAxis=y,exports.add=q,exports.multiply=L,exports.scale=T,exports.lerp=_,exports.invert=I,exports.conjugate=N,exports.normalize=Q,exports.str=V,exports.exactEquals=X,exports.equals=Z,exports.sqrLen=exports.squaredLength=exports.len=exports.length=exports.dot=exports.mul=exports.setReal=exports.getReal=void 0;var t=a(require("./common.js")),r=a(require("./quat.js")),e=a(require("./mat4.js"));function a(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,e):{};a.get||a.set?Object.defineProperty(r,e,a):r[e]=t[e]}return r.default=t,r}function n(){var r=new t.ARRAY_TYPE(8);return t.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0),r[3]=1,r}function o(r){var e=new t.ARRAY_TYPE(8);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e}function s(r,e,a,n,o,s,u,p){var i=new t.ARRAY_TYPE(8);return i[0]=r,i[1]=e,i[2]=a,i[3]=n,i[4]=o,i[5]=s,i[6]=u,i[7]=p,i}function u(r,e,a,n,o,s,u){var p=new t.ARRAY_TYPE(8);p[0]=r,p[1]=e,p[2]=a,p[3]=n;var i=.5*o,x=.5*s,c=.5*u;return p[4]=i*n+x*a-c*e,p[5]=x*n+c*r-i*a,p[6]=c*n+i*e-x*r,p[7]=-i*r-x*e-c*a,p}function p(t,r,e){var a=.5*e[0],n=.5*e[1],o=.5*e[2],s=r[0],u=r[1],p=r[2],i=r[3];return t[0]=s,t[1]=u,t[2]=p,t[3]=i,t[4]=a*i+n*p-o*u,t[5]=n*i+o*s-a*p,t[6]=o*i+a*u-n*s,t[7]=-a*s-n*u-o*p,t}function i(t,r){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*r[0],t[5]=.5*r[1],t[6]=.5*r[2],t[7]=0,t}function x(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function c(a,n){var o=r.create();e.getRotation(o,n);var s=new t.ARRAY_TYPE(3);return e.getTranslation(s,n),p(a,o,s),a}function f(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t}function h(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function M(t,r,e,a,n,o,s,u,p){return t[0]=r,t[1]=e,t[2]=a,t[3]=n,t[4]=o,t[5]=s,t[6]=u,t[7]=p,t}var v=r.copy;function l(t,r){return t[0]=r[4],t[1]=r[5],t[2]=r[6],t[3]=r[7],t}exports.getReal=v;var b=r.copy;function P(t,r){return t[4]=r[0],t[5]=r[1],t[6]=r[2],t[7]=r[3],t}function m(t,r){var e=r[4],a=r[5],n=r[6],o=r[7],s=-r[0],u=-r[1],p=-r[2],i=r[3];return t[0]=2*(e*i+o*s+a*p-n*u),t[1]=2*(a*i+o*u+n*s-e*p),t[2]=2*(n*i+o*p+e*u-a*s),t}function R(t,r,e){var a=r[0],n=r[1],o=r[2],s=r[3],u=.5*e[0],p=.5*e[1],i=.5*e[2],x=r[4],c=r[5],f=r[6],h=r[7];return t[0]=a,t[1]=n,t[2]=o,t[3]=s,t[4]=s*u+n*i-o*p+x,t[5]=s*p+o*u-a*i+c,t[6]=s*i+a*p-n*u+f,t[7]=-a*u-n*p-o*i+h,t}function d(t,e,a){var n=-e[0],o=-e[1],s=-e[2],u=e[3],p=e[4],i=e[5],x=e[6],c=e[7],f=p*u+c*n+i*s-x*o,h=i*u+c*o+x*n-p*s,M=x*u+c*s+p*o-i*n,v=c*u-p*n-i*o-x*s;return r.rotateX(t,e,a),n=t[0],o=t[1],s=t[2],u=t[3],t[4]=f*u+v*n+h*s-M*o,t[5]=h*u+v*o+M*n-f*s,t[6]=M*u+v*s+f*o-h*n,t[7]=v*u-f*n-h*o-M*s,t}function O(t,e,a){var n=-e[0],o=-e[1],s=-e[2],u=e[3],p=e[4],i=e[5],x=e[6],c=e[7],f=p*u+c*n+i*s-x*o,h=i*u+c*o+x*n-p*s,M=x*u+c*s+p*o-i*n,v=c*u-p*n-i*o-x*s;return r.rotateY(t,e,a),n=t[0],o=t[1],s=t[2],u=t[3],t[4]=f*u+v*n+h*s-M*o,t[5]=h*u+v*o+M*n-f*s,t[6]=M*u+v*s+f*o-h*n,t[7]=v*u-f*n-h*o-M*s,t}function g(t,e,a){var n=-e[0],o=-e[1],s=-e[2],u=e[3],p=e[4],i=e[5],x=e[6],c=e[7],f=p*u+c*n+i*s-x*o,h=i*u+c*o+x*n-p*s,M=x*u+c*s+p*o-i*n,v=c*u-p*n-i*o-x*s;return r.rotateZ(t,e,a),n=t[0],o=t[1],s=t[2],u=t[3],t[4]=f*u+v*n+h*s-M*o,t[5]=h*u+v*o+M*n-f*s,t[6]=M*u+v*s+f*o-h*n,t[7]=v*u-f*n-h*o-M*s,t}function A(t,r,e){var a=e[0],n=e[1],o=e[2],s=e[3],u=r[0],p=r[1],i=r[2],x=r[3];return t[0]=u*s+x*a+p*o-i*n,t[1]=p*s+x*n+i*a-u*o,t[2]=i*s+x*o+u*n-p*a,t[3]=x*s-u*a-p*n-i*o,u=r[4],p=r[5],i=r[6],x=r[7],t[4]=u*s+x*a+p*o-i*n,t[5]=p*s+x*n+i*a-u*o,t[6]=i*s+x*o+u*n-p*a,t[7]=x*s-u*a-p*n-i*o,t}function E(t,r,e){var a=r[0],n=r[1],o=r[2],s=r[3],u=e[0],p=e[1],i=e[2],x=e[3];return t[0]=a*x+s*u+n*i-o*p,t[1]=n*x+s*p+o*u-a*i,t[2]=o*x+s*i+a*p-n*u,t[3]=s*x-a*u-n*p-o*i,u=e[4],p=e[5],i=e[6],x=e[7],t[4]=a*x+s*u+n*i-o*p,t[5]=n*x+s*p+o*u-a*i,t[6]=o*x+s*i+a*p-n*u,t[7]=s*x-a*u-n*p-o*i,t}function y(r,e,a,n){if(Math.abs(n)<t.EPSILON)return f(r,e);var o=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);n*=.5;var s=Math.sin(n),u=s*a[0]/o,p=s*a[1]/o,i=s*a[2]/o,x=Math.cos(n),c=e[0],h=e[1],M=e[2],v=e[3];r[0]=c*x+v*u+h*i-M*p,r[1]=h*x+v*p+M*u-c*i,r[2]=M*x+v*i+c*p-h*u,r[3]=v*x-c*u-h*p-M*i;var l=e[4],b=e[5],P=e[6],m=e[7];return r[4]=l*x+m*u+b*i-P*p,r[5]=b*x+m*p+P*u-l*i,r[6]=P*x+m*i+l*p-b*u,r[7]=m*x-l*u-b*p-P*i,r}function q(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t[4]=r[4]+e[4],t[5]=r[5]+e[5],t[6]=r[6]+e[6],t[7]=r[7]+e[7],t}function L(t,r,e){var a=r[0],n=r[1],o=r[2],s=r[3],u=e[4],p=e[5],i=e[6],x=e[7],c=r[4],f=r[5],h=r[6],M=r[7],v=e[0],l=e[1],b=e[2],P=e[3];return t[0]=a*P+s*v+n*b-o*l,t[1]=n*P+s*l+o*v-a*b,t[2]=o*P+s*b+a*l-n*v,t[3]=s*P-a*v-n*l-o*b,t[4]=a*x+s*u+n*i-o*p+c*P+M*v+f*b-h*l,t[5]=n*x+s*p+o*u-a*i+f*P+M*l+h*v-c*b,t[6]=o*x+s*i+a*p-n*u+h*P+M*b+c*l-f*v,t[7]=s*x-a*u-n*p-o*i+M*P-c*v-f*l-h*b,t}exports.setReal=b;var Y=L;function T(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t[4]=r[4]*e,t[5]=r[5]*e,t[6]=r[6]*e,t[7]=r[7]*e,t}exports.mul=Y;var j=r.dot;function _(t,r,e,a){var n=1-a;return j(r,e)<0&&(a=-a),t[0]=r[0]*n+e[0]*a,t[1]=r[1]*n+e[1]*a,t[2]=r[2]*n+e[2]*a,t[3]=r[3]*n+e[3]*a,t[4]=r[4]*n+e[4]*a,t[5]=r[5]*n+e[5]*a,t[6]=r[6]*n+e[6]*a,t[7]=r[7]*n+e[7]*a,t}function I(t,r){var e=D(r);return t[0]=-r[0]/e,t[1]=-r[1]/e,t[2]=-r[2]/e,t[3]=r[3]/e,t[4]=-r[4]/e,t[5]=-r[5]/e,t[6]=-r[6]/e,t[7]=r[7]/e,t}function N(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=r[3],t[4]=-r[4],t[5]=-r[5],t[6]=-r[6],t[7]=r[7],t}exports.dot=j;var S=r.length;exports.length=S;var w=S;exports.len=w;var D=r.squaredLength;exports.squaredLength=D;var B=D;function Q(t,r){var e=D(r);if(e>0){e=Math.sqrt(e);var a=r[0]/e,n=r[1]/e,o=r[2]/e,s=r[3]/e,u=r[4],p=r[5],i=r[6],x=r[7],c=a*u+n*p+o*i+s*x;t[0]=a,t[1]=n,t[2]=o,t[3]=s,t[4]=(u-a*c)/e,t[5]=(p-n*c)/e,t[6]=(i-o*c)/e,t[7]=(x-s*c)/e}return t}function V(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function X(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]&&t[6]===r[6]&&t[7]===r[7]}function Z(r,e){var a=r[0],n=r[1],o=r[2],s=r[3],u=r[4],p=r[5],i=r[6],x=r[7],c=e[0],f=e[1],h=e[2],M=e[3],v=e[4],l=e[5],b=e[6],P=e[7];return Math.abs(a-c)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(n-f)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(o-h)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-M)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-v)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(p-l)<=t.EPSILON*Math.max(1,Math.abs(p),Math.abs(l))&&Math.abs(i-b)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(x-P)<=t.EPSILON*Math.max(1,Math.abs(x),Math.abs(P))}exports.sqrLen=B;
},{"./common.js":"XJqx","./quat.js":"1KdR","./mat4.js":"w3aR"}],"XSo1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=e,exports.clone=n,exports.fromValues=o,exports.copy=a,exports.set=s,exports.add=u,exports.subtract=i,exports.multiply=c,exports.divide=p,exports.ceil=x,exports.floor=f,exports.min=v,exports.max=h,exports.round=M,exports.scale=l,exports.scaleAndAdd=d,exports.distance=m,exports.squaredDistance=b,exports.length=q,exports.squaredLength=P,exports.negate=A,exports.inverse=O,exports.normalize=y,exports.dot=g,exports.cross=E,exports.lerp=R,exports.random=Y,exports.transformMat2=_,exports.transformMat2d=j,exports.transformMat3=w,exports.transformMat4=D,exports.rotate=L,exports.angle=I,exports.zero=T,exports.str=N,exports.exactEquals=z,exports.equals=S,exports.forEach=exports.sqrLen=exports.sqrDist=exports.dist=exports.div=exports.mul=exports.sub=exports.len=void 0;var r=t(require("./common.js"));function t(r){if(r&&r.__esModule)return r;var t={};if(null!=r)for(var e in r)if(Object.prototype.hasOwnProperty.call(r,e)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,e):{};n.get||n.set?Object.defineProperty(t,e,n):t[e]=r[e]}return t.default=r,t}function e(){var t=new r.ARRAY_TYPE(2);return r.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function n(t){var e=new r.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e}function o(t,e){var n=new r.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n}function a(r,t){return r[0]=t[0],r[1]=t[1],r}function s(r,t,e){return r[0]=t,r[1]=e,r}function u(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r}function i(r,t,e){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r}function c(r,t,e){return r[0]=t[0]*e[0],r[1]=t[1]*e[1],r}function p(r,t,e){return r[0]=t[0]/e[0],r[1]=t[1]/e[1],r}function x(r,t){return r[0]=Math.ceil(t[0]),r[1]=Math.ceil(t[1]),r}function f(r,t){return r[0]=Math.floor(t[0]),r[1]=Math.floor(t[1]),r}function v(r,t,e){return r[0]=Math.min(t[0],e[0]),r[1]=Math.min(t[1],e[1]),r}function h(r,t,e){return r[0]=Math.max(t[0],e[0]),r[1]=Math.max(t[1],e[1]),r}function M(r,t){return r[0]=Math.round(t[0]),r[1]=Math.round(t[1]),r}function l(r,t,e){return r[0]=t[0]*e,r[1]=t[1]*e,r}function d(r,t,e,n){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r}function m(r,t){var e=t[0]-r[0],n=t[1]-r[1];return Math.sqrt(e*e+n*n)}function b(r,t){var e=t[0]-r[0],n=t[1]-r[1];return e*e+n*n}function q(r){var t=r[0],e=r[1];return Math.sqrt(t*t+e*e)}function P(r){var t=r[0],e=r[1];return t*t+e*e}function A(r,t){return r[0]=-t[0],r[1]=-t[1],r}function O(r,t){return r[0]=1/t[0],r[1]=1/t[1],r}function y(r,t){var e=t[0],n=t[1],o=e*e+n*n;return o>0&&(o=1/Math.sqrt(o)),r[0]=t[0]*o,r[1]=t[1]*o,r}function g(r,t){return r[0]*t[0]+r[1]*t[1]}function E(r,t,e){var n=t[0]*e[1]-t[1]*e[0];return r[0]=r[1]=0,r[2]=n,r}function R(r,t,e,n){var o=t[0],a=t[1];return r[0]=o+n*(e[0]-o),r[1]=a+n*(e[1]-a),r}function Y(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function _(r,t,e){var n=t[0],o=t[1];return r[0]=e[0]*n+e[2]*o,r[1]=e[1]*n+e[3]*o,r}function j(r,t,e){var n=t[0],o=t[1];return r[0]=e[0]*n+e[2]*o+e[4],r[1]=e[1]*n+e[3]*o+e[5],r}function w(r,t,e){var n=t[0],o=t[1];return r[0]=e[0]*n+e[3]*o+e[6],r[1]=e[1]*n+e[4]*o+e[7],r}function D(r,t,e){var n=t[0],o=t[1];return r[0]=e[0]*n+e[4]*o+e[12],r[1]=e[1]*n+e[5]*o+e[13],r}function L(r,t,e,n){var o=t[0]-e[0],a=t[1]-e[1],s=Math.sin(n),u=Math.cos(n);return r[0]=o*u-a*s+e[0],r[1]=o*s+a*u+e[1],r}function I(r,t){var e=r[0],n=r[1],o=t[0],a=t[1],s=e*e+n*n;s>0&&(s=1/Math.sqrt(s));var u=o*o+a*a;u>0&&(u=1/Math.sqrt(u));var i=(e*o+n*a)*s*u;return i>1?0:i<-1?Math.PI:Math.acos(i)}function T(r){return r[0]=0,r[1]=0,r}function N(r){return"vec2("+r[0]+", "+r[1]+")"}function z(r,t){return r[0]===t[0]&&r[1]===t[1]}function S(t,e){var n=t[0],o=t[1],a=e[0],s=e[1];return Math.abs(n-a)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(o-s)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(s))}var F=q;exports.len=F;var V=i;exports.sub=V;var k=c;exports.mul=k;var B=p;exports.div=B;var C=m;exports.dist=C;var G=b;exports.sqrDist=G;var H=P;exports.sqrLen=H;var J=function(){var r=e();return function(t,e,n,o,a,s){var u,i;for(e||(e=2),n||(n=0),i=o?Math.min(o*e+n,t.length):t.length,u=n;u<i;u+=e)r[0]=t[u],r[1]=t[u+1],a(r,r,s),t[u]=r[0],t[u+1]=r[1];return t}}();exports.forEach=J;
},{"./common.js":"XJqx"}],"IF0X":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.vec4=exports.vec3=exports.vec2=exports.quat2=exports.quat=exports.mat4=exports.mat3=exports.mat2d=exports.mat2=exports.glMatrix=void 0;var e=x(require("./common.js"));exports.glMatrix=e;var r=x(require("./mat2.js"));exports.mat2=r;var t=x(require("./mat2d.js"));exports.mat2d=t;var s=x(require("./mat3.js"));exports.mat3=s;var o=x(require("./mat4.js"));exports.mat4=o;var a=x(require("./quat.js"));exports.quat=a;var p=x(require("./quat2.js"));exports.quat2=p;var u=x(require("./vec2.js"));exports.vec2=u;var i=x(require("./vec3.js"));exports.vec3=i;var v=x(require("./vec4.js"));function x(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var s=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};s.get||s.set?Object.defineProperty(r,t,s):r[t]=e[t]}return r.default=e,r}exports.vec4=v;
},{"./common.js":"XJqx","./mat2.js":"eN7R","./mat2d.js":"M21d","./mat3.js":"vtQf","./mat4.js":"w3aR","./quat.js":"1KdR","./quat2.js":"6buG","./vec2.js":"XSo1","./vec3.js":"AWBd","./vec4.js":"9+zW"}],"KpHM":[function(require,module,exports) {
module.exports="#version 300 es\n#define GLSLIFY 1\nlayout(location = 0) in float a_id;\n\nuniform uint u_num_particles;\nuniform mediump float u_radius;\nuniform sampler2D u_pos_buf;\nuniform mediump mat4 u_view;\nuniform mediump mat4 u_proj;\nuniform uint u_vpheight;\n\nout vec3 _pos;\nflat out float _id;\n\nvoid main() {\n  vec2 in_pos = texture(u_pos_buf, vec2(a_id / float(u_num_particles), 0)).xy;\n  vec4 pos = vec4(in_pos, 0.f, 1.f);\n  gl_Position = u_proj * u_view * pos;\n  gl_PointSize = float(u_vpheight) * u_proj[1][1] * u_radius / gl_Position.w;\n\n  _pos = pos.xyz;\n  _id = a_id;\n}\n";
},{}],"BIBG":[function(require,module,exports) {
module.exports="#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\n\nin vec3 _pos;\nflat in float _id;\n\nuniform float u_radius;\nuniform vec3 u_camera;\nuniform mediump mat4 u_view;\nuniform mediump mat4 u_proj;\n\nout vec4 f_color;\n\nconst vec3 ambient = vec3(0.05f, 0.2f, 0.3f);\nconst vec3 color = vec3(0.15f, 0.65f, 1.f);\n\nvoid main() {\n  vec3 n;\n  n.xy = 2.f * gl_PointCoord.st - vec2(1.f);\n  n.y = -n.y;\n  float r2 = length(n.xy);\n  if (r2 > 1.f)\n    discard;\n  n.z = sqrt(1.f - r2);\n\n  vec4 pos = vec4((u_view * vec4(_pos, 1.f)).xyz + n * u_radius, 1.f);\n  vec4 clip_pos = u_proj * pos;\n  float depth = (1.f + clip_pos.z / clip_pos.w) / 2.f;\n  gl_FragDepth = gl_DepthRange.near + gl_DepthRange.diff * depth;\n\n  vec4 lpos_view = u_view * vec4(u_camera.x - 1.f, u_camera.y + 0.5f, 1.f, 1.f);\n  float diffuse = clamp(dot(n, lpos_view.xyz - pos.xyz), 0.f, 1.f);\n\n  f_color = vec4(ambient + diffuse * color.xyz, 1.f);\n}";
},{}],"YAuA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r=require("gl-matrix"),e=i(require("./shaders/render.vert")),u=i(require("./shaders/render.frag")),a=require("~/src/gl-util");function i(r){return r&&r.__esModule?r:{default:r}}var t=function(i,t,s){return function(){var n,_,f;return{init:function(){_=r.mat4.create();var o=s.r_params.width/2,c=s.r_params.height/2,m=r.vec3.fromValues(o,c,3);r.mat4.lookAt(_,m,r.vec3.fromValues(o,c,0),r.vec3.fromValues(0,1,0)),f=r.mat4.create(),r.mat4.perspective(f,45*Math.PI/180,i.canvas.clientWidth/i.canvas.clientHeight,.1,100),n=new a.Program(i,"render",e.default,u.default,{attrs:["a_id"],uniforms:{u_num_particles:"1ui",u_pos_buf:"1i",u_radius:"1f",u_vpheight:"1ui",u_view:"Matrix4fv",u_proj:"Matrix4fv",u_camera:"3fv"}}),i.bindBuffer(i.ARRAY_BUFFER,s.buffers.particle_ids),n.attr("a_id",1,i.UNSIGNED_SHORT,!1,0,0).use().uniform("u_pos_buf",0).uniform("u_radius",t.is_mac?2*s.r_params.radius:s.r_params.radius).uniform("u_num_particles",s.num_particles).uniform("u_vpheight",i.canvas.height).uniform("u_camera",m).uniform("u_view",!1,_).uniform("u_proj",!1,f).unuse()},exec:function(){var r=t.canvas;t.input,t.is_mac,t.renderer,i.bindFramebuffer(i.FRAMEBUFFER,null),i.activeTexture(i.TEXTURE0),s.textures.pos.bind(),n.use(),i.clearColor(.2,.2,.2,1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.viewport(0,0,r.width,r.height),i.drawArrays(i.POINTS,0,s.num_particles),n.unuse()}}}()};exports.default=t;
},{"gl-matrix":"IF0X","./shaders/render.vert":"KpHM","./shaders/render.frag":"BIBG","~/src/gl-util":"3fHx"}],"EQ8R":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("~/src/gl-util"),t=p(require("./steps/s1-pred-pos")),s=p(require("./steps/s2-jank-frnn")),i=p(require("./steps/s3-calc-lambda")),r=p(require("./steps/s4-calc-dp")),n=p(require("./steps/s5-update-pred-pos")),a=p(require("./steps/s6-update-vel")),u=p(require("./steps/s7-update-pos")),l=p(require("./steps/s8-render-particles"));function p(e){return e&&e.__esModule?e:{default:e}}function _(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{},i=Object.keys(s);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable}))),i.forEach(function(t){h(e,t,s[t])})}return e}function h(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,s){return t&&c(e.prototype,t),s&&c(e,s),e}var d=function(p,h){return function(){function c(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];f(this,c),this.next_id=-1,this.particles=[],this.params_dirty=!1,this.framebuffer=1,this.framebuffers=[],this.s_params={dt:.0083,kernel_r:.1,bin_size:.1,rest_density:8e3,relaxation:1e3,s_corr_dq_mult:.01,s_corr_k:2e-4,s_corr_n:3,vort_eps:8e-5,visc_c:1e-6,x_bins:0,y_bins:0,num_bins:0},this.r_params={height:2,width:4,radius:.1},this.buffers={particle_ids:null},this.textures={pos:null,vel:null,pred_pos:null,d_pos:null,den:null,temp:null,bins:null,bin_start:null,bin_count:null},this.steps={pred_pos:(0,t.default)(h,p,this),jank_frnn:(0,s.default)(h,p,this),calc_lambda:(0,i.default)(h,p,this),calc_dp:(0,r.default)(h,p,this),update_pred_pos:(0,n.default)(h,p,this),update_vel:(0,a.default)(h,p,this),update_pos:(0,u.default)(h,p,this),render_particles:(0,l.default)(h,p,this)},this.init()}return o(c,[{key:"init",value:function(){this.compute_bounds();var e=this.generate_particles({w:2,h:2,o_x:this.r_params.width/2,o_y:this.r_params.height/2,d_x:30,d_y:20});p.info=_({},p.info,{particles:this.num_particles}),this.init_buffers(),this.init_textures(e),this.init_programs(),this.init_framebuffers()}},{key:"generate_particles",value:function(e){for(var t=e.o_x,s=void 0===t?0:t,i=e.o_y,r=void 0===i?0:i,n=e.w,a=void 0===n?1:n,u=e.h,l=void 0===u?1:u,p=e.d_x,_=void 0===p?10:p,h=e.d_y,f=[],c=a*_,o=l*(void 0===h?10:h),d=a/c,b=l/o,m=-c/2;m<c/2;++m)for(var x=-o/2;x<o/2;++x)f.push(s+m*d,r+x*b),this.particles.push(++this.next_id);return f}},{key:"compute_bounds",value:function(){var e=this.s_params.bin_size,t=this.r_params,s=t.height,i=t.width,r=Math.ceil(s/e),n=Math.ceil(i/e);this.s_params.y_bins=r,this.s_params.x_bins=n,this.s_params.num_bins=r*n}},{key:"init_buffers",value:function(){this.buffers.particle_ids=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,this.buffers.particle_ids),h.bufferData(h.ARRAY_BUFFER,new Uint16Array(this.particles),h.STATIC_DRAW),h.bindBuffer(h.ARRAY_BUFFER,null)}},{key:"init_programs",value:function(){this.steps.pred_pos.init(),this.steps.jank_frnn.init(),this.steps.calc_lambda.init(),this.steps.calc_dp.init(),this.steps.update_pred_pos.init(),this.steps.update_vel.init(),this.steps.update_pos.init(),this.steps.render_particles.init()}},{key:"init_textures",value:function(t){var s=new e.Texture(h,0,h.RG32F,this.num_particles,1,0,h.RG,h.FLOAT,new Float32Array(t)),i=new e.Texture(h,0,h.RG32F,this.num_particles,1,0,h.RG,h.FLOAT,new Float32Array(2*this.num_particles)),r=new e.Texture(h,0,h.RG32F,this.num_particles,1,0,h.RG,h.FLOAT,null),n=new e.Texture(h,0,h.R32UI,this.num_particles,1,0,h.RED_INTEGER,h.UNSIGNED_INT,null),a=new e.Texture(h,0,h.R32UI,this.s_params.num_bins,1,0,h.RED_INTEGER,h.UNSIGNED_INT,null),u=new e.Texture(h,0,h.R32UI,this.s_params.num_bins,1,0,h.RED_INTEGER,h.UNSIGNED_INT,null),l=new e.Texture(h,0,h.R32F,this.num_particles,1,0,h.RED,h.FLOAT,null),p=new e.Texture(h,0,h.RG32F,this.num_particles,1,0,h.RG,h.FLOAT,null),_=new e.Texture(h,0,h.RG32F,this.num_particles,1,0,h.RG,h.FLOAT,null);this.textures.pos=s,this.textures.vel=i,this.textures.pred_pos=r,this.textures.bins=n,this.textures.bin_count=a,this.textures.bin_start=u,this.textures.den=l,this.textures.d_pos=p,this.textures.temp=_}},{key:"init_framebuffers",value:function(){this.framebuffers.push(h.createFramebuffer()),this.framebuffers.push(h.createFramebuffer())}},{key:"swap_fbo",value:function(){return this.framebuffer=1-this.framebuffer,this.framebuffers[this.framebuffer]}},{key:"step",value:function(e){if(this.reset_pending)this.reset();else{this.steps.pred_pos.exec(),this.steps.jank_frnn.exec();for(var t=0;t<3;++t)this.steps.calc_lambda.exec(),this.steps.calc_dp.exec(),this.steps.update_pred_pos.exec();this.steps.update_vel.exec(),this.steps.update_pos.exec()}}},{key:"render",value:function(){this.steps.render_particles.exec()}},{key:"reset",value:function(){this.next_id=-1,this.particles.length=0;var e=this.generate_particles({w:2,h:2,o_x:this.r_params.width/2,o_y:this.r_params.height/2,d_x:30,d_y:20});this.textures.pos.bind(),h.texImage2D(h.TEXTURE_2D,0,h.RG32F,this.num_particles,1,0,h.RG,h.FLOAT,new Float32Array(e)),this.textures.vel.bind(),h.texImage2D(h.TEXTURE_2D,0,h.RG32F,this.num_particles,1,0,h.RG,h.FLOAT,new Float32Array(2*this.num_particles)),this.render()}},{key:"num_particles",get:function(){return this.particles.length}}]),c}()};exports.default=d;
},{"~/src/gl-util":"3fHx","./steps/s1-pred-pos":"Vbf9","./steps/s2-jank-frnn":"SQxo","./steps/s3-calc-lambda":"ktUN","./steps/s4-calc-dp":"x0rW","./steps/s5-update-pred-pos":"LfWM","./steps/s6-update-vel":"euvS","./steps/s7-update-pos":"YHhg","./steps/s8-render-particles":"YAuA"}],"xVhK":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var i=function(t){return function(){function i(){e(this,i);var t=document.createElement("div");t.setAttribute("id","info-box"),t.style.position="fixed",t.style.top=0,t.style.left=0,t.style.border="1px solid white",t.style.color="white",t.style.padding="0.4em",t.style.fontSize="0.8em",document.body.appendChild(t);var n=document.createElement("button");n.innerHTML="start",n.setAttribute("id","pause"),t.appendChild(n);var s=document.createElement("button");s.innerHTML="reset",s.setAttribute("id","reset"),t.appendChild(s);var r=document.createElement("div");t.appendChild(r),this.div=t,this.pause_button=n,this.info_elem=r,this._info={},this.on_pause=this.on_pause.bind(this),n.addEventListener("click",this.on_pause),this.on_reset=this.on_reset.bind(this),s.addEventListener("click",this.on_reset)}return n(i,[{key:"on_pause",value:function(){t.paused?(this.pause_button.innerHTML="pause",t.run()):(this.pause_button.innerHTML="resume",t.pause())}},{key:"sync",value:function(){t.paused?this.pause_button.innerHTML="resume":this.pause_button.innerHTML="pause"}},{key:"on_reset",value:function(){!t.reset_pending&&t.reset()}},{key:"info",get:function(){return this._info},set:function(e){this._info=e,this.info_elem.innerHTML="<pre>".concat(JSON.stringify(e,null,2),"</pre>")}}]),i}()};exports.default=i;
},{}],"J3mu":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var i=function(e,i){return function(){function r(){t(this,r),this.running=!1,this.avg_fps=0,this.t_curr=0,this.t_last=0,this.on_frame=this.on_frame.bind(this),this.on_resize=this.on_resize.bind(this)}return n(r,[{key:"init",value:function(){i.getExtension("EXT_color_buffer_float"),i.clearDepth(1),i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL),window.addEventListener("resize",this.on_resize)}},{key:"start",value:function(){this.running=!0,window.requestAnimationFrame(this.on_frame)}},{key:"on_frame",value:function(t){if(this.running){this.t_last=this.t_curr,this.t_curr=t;var n=t-this.t_last;this.avg_fps=.5*(1e3/n+this.avg_fps),e.sim.step(n),e.sim.render(),window.requestAnimationFrame(this.on_frame)}}},{key:"on_resize",value:function(){var t=e.canvas;e.is_mac?(t.height=2*t.clientHeight,t.width=2*t.clientWidth):(t.height=t.clientHeight,t.width=t.clientWidth)}},{key:"pause",value:function(){this.running=!1}},{key:"destroy",value:function(){}}]),r}()};exports.default=i;
},{}],"m9zS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("./input-manager")),t=r(require("./sim")),i=r(require("./ui-interface")),n=r(require("./renderer"));function r(e){return e&&e.__esModule?e:{default:e}}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(t){o(e,t,i[t])})}return e}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,i){return t&&u(e.prototype,t),i&&u(e,i),e}var h=function(){function r(t){if(a(this,r),this.canvas=document.getElementById(t),!this.canvas)throw new Error("canvas element not found");this.initialized=!1,this.paused=!0,this.is_mac=/mac/i.test(window.navigator.platform),this.gl=null,this.sim=null,this.renderer=null,this.input=new e.default,this.info_box=new((0,i.default)(this)),this.sample_performance=this.sample_performance.bind(this),this.on_mousemove=this.on_mousemove.bind(this),this.input.on("mousemove",this.on_mousemove)}return f(r,[{key:"init",value:function(){this.info_box.info={state:"initializing..."};var e=this.canvas.getContext("webgl2");if(!e)throw new Error("webgl context could not be created");this.gl=e,this.sim=new((0,t.default)(this,e)),this.renderer=new((0,n.default)(this,e)),this.renderer.init(),this.renderer.on_resize(),this.initialized=!0,this.info=s({},this.info,{state:"initialized"}),this.sim.render()}},{key:"on_mousemove",value:function(e){this.info=s({},this.info,{mouse:"".concat(e.mouse.x,", ").concat(e.mouse.y)})}},{key:"run",value:function(){if(!this.initialized)throw new Error("application has not been initialized");this.paused=!1,this.info=s({},this.info,{state:"running"}),this.renderer.start(),window.setTimeout(this.sample_performance,1e3)}},{key:"sample_performance",value:function(){if(this.renderer.running){this.t,this.tLast;this.info=s({},this.info,{fps:"".concat(this.renderer.avg_fps.toFixed(2)," fps")}),window.setTimeout(this.sample_performance,1e3)}}},{key:"pause",value:function(){this.info=s({},this.info,{state:"paused"}),delete this.info.fps,this.renderer.pause(),this.paused=!0}},{key:"reset",value:function(){this.pause(),this.sim.reset(),this.info_box.sync()}},{key:"reset_pending",get:function(){return this.sim.reset_pending}},{key:"info",get:function(){return this.info_box.info},set:function(e){this.info_box.info=e}}]),r}();exports.default=h;
},{"./input-manager":"PVdp","./sim":"EQ8R","./ui-interface":"xVhK","./renderer":"J3mu"}],"HJD/":[function(require,module,exports) {
"use strict";var e=t(require("./app"));function t(e){return e&&e.__esModule?e:{default:e}}function u(){new e.default("view").init()}u();
},{"./app":"m9zS"}]},{},["HJD/"], null)
//# sourceMappingURL=main.aa6cc7d0.js.map